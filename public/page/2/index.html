
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>> pshdo</title>
  <meta name="author" content="Aaron Jensen">

  
  <meta name="description" content="Carbon v1.5 is out and is backwards compatible with v1.0 through v1.4. This release adds a few new features and some bug fixes to improve PowerShell &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pshdo.com/page/2/index.html">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pshdo.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/archive/atom.xml" rel="alternate" title="> pshdo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">> pshdo</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/archive/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pshdo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
	<li><a href="/about">About</a></li>
	<li><a href="/archive">Archive</a></li>
	<li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/09/carbon-v15-released.html">Carbon v1.5 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-06T09:35:00-07:00" pubdate data-updated="true">Sep 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.5 is out and is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.4.  This release adds a few new features and some bug fixes to improve PowerShell 3 support.</p>

<p>This is definitely the last release to support PowerShell 2.  There were enough bug fixes that I didn&rsquo;t feel good about making people upgrade to a backwards-incompatible version to get them, so I jumped through some extra hoops to test on PowerShell 2.  You&rsquo;re welcome.  <code>;-)</code></p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="iis">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-IisWebsiteID.html">Set-IisWebsiteID</a> now attempts to start a website whose ID has changed, since IIS stops a website whenever its ID changes.</li>
</ul>

<h3 id="network">Network</h3>

<ul>
  <li>Added <a href="http://get-carbon.org/help/Get-IPAddress.html">Get-IPAddress</a> function for getting the IPv4/IPv6 addresses currently in use on the local computer&rsquo;s network interfaces.</li>
  <li>Added <a href="http://get-carbon.org/help/Test-IPAddress.html">Test-IPAddress</a> function for testing if an IP address is in use on one the local computer&rsquo;s network interfaces.</li>
</ul>

<h3 id="path">Path</h3>

<ul>
  <li>Added <a href="http://get-carbon.org/help/Test-UncPath.html">Test-UncPath</a> function for testing if a path is a UNC or not.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now runs script blocks in PowerShell 3 under a v2.0 CLR.</li>
</ul>

<h3 id="shares">Shares</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> now creates the share&rsquo;s directory if it doesn&rsquo;t exist.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="certificates">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> throws an exception and halts script execution when loading a certificate file with a private key and the user doesn&rsquo;t have permission to write to Windows&rsquo; MachineKeys directory.  It now writes an error instead.</li>
</ul>

<h3 id="powershell-1">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> doesn&rsquo;t run under a v2.0 CLR when using parameters <code>-Runtime 'v2.0'</code>.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/08/carbon-v14-released.html">Carbon v1.4 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-10T03:50:00-07:00" pubdate data-updated="true">Aug 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.4 is out and is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.3.  This release adds a few new features and some bug fixes introduced in v1.3.</p>

<p>This will most likely be the last version of Carbon tested and supported on PowerShell 2.  We&rsquo;ll be moving the build server to PowerShell 3 sometime around August 15th, which means that&rsquo;s the version of PowerShell the automated tests will use.  We encourage everyone to upgrade to PowerShell 3 as soon as possible.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="file-system">File System</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Install-Junction.html">Install-Junction</a> function for creating new and/or updating existing junctions. This is a more idempotent way of creating junctions, as opposed to <a href="http://get-carbon.org/help/New-Junction.html">New-Junction</a> and <a href="http://get-carbon.org/help/Remove-Junction.html">Remove-Junction</a> which report errors if a junction already exists or doesn&rsquo;t exist, respectively.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Objects returned by <a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a> now have a dynamic <code>PhysicalPath</code> script property, so you don&rsquo;t have to traverse down into the default application&rsquo;s default virtual directory object to get it.</li>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a>, <a href="http://get-carbon.org/help/Install-IisWebsite.html">Install-IisWebsite</a>, and <a href="http://get-carbon.org/help/Install-IisVirtualDirectory.html">Install-IisVirtualDirectory</a> now canonicalize physical paths, i.e. they convert any path with a relative part (e.g. &lsquo;..&rsquo;) to a full path.  It turns out IIS doesn&rsquo;t like paths with relative parts.</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisApplication.html">Get-IisApplication</a> function to get <code>Microsoft.Web.Administration.Application</code> objects for all or specific applications under a website.</li>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a> now uses the <code>Microsoft.Web.Administration</code> API instead of <code>appcmd.exe</code>.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li>Added <code>ExecutionPolicy</code> parameter to <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> to allow setting a custom exeuction policy when using <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> to run a script.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="iis-1">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a> not updating/changing physical path on existing application.</li>
</ul>

<h3 id="net">.NET</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-DotNetAppSetting.html">Set-DotNetAppSetting</a> and <a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString</a> failed if setting .NET configuration under an architecture where the PowerShell execution policy doesn&rsquo;t allow running scripts.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/carbon-v13-released.html">Carbon v1.3 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-08T21:39:00-07:00" pubdate data-updated="true">Jul 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.3 is out, is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.2.  This release  improves PowerShell 3 compatibility, updates <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> so it can run scripts, and adds <a href="http://get-carbon.org/help/ConvertTo-Base64.html">ConvertTo-Base64</a> and <a href="http://get-carbon.org/help/ConvertFrom-Base64.html">ConvertFrom-Base64</a> functions.</p>

<p>Thanks to <a href="http://blog.codeassassin.com/">Jason Stangroome</a> for the feedback that contributed to the work done in this release.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now supports running an external script.</li>
  <li>Added <code>OutputFormat</code> argument to <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> so your scripts/script blocks can return XML results instead of plain text.</li>
  <li>Renamed <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a>&rsquo;s <code>Args</code> parameter to <code>ArgumentList</code> (with backwards compatibile <code>Args</code> alias).</li>
  <li>Renamed <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a>&rsquo;s <code>Command</code> parameter to <code>ScriptBlock</code> (with backwards-compatible <code>Command</code> alias).</li>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now runs 64-bit PowerShell from 32-bit PowerShell.</li>
  <li><a href="http://get-carbon.org/help/Get-PowerShellPath.html">Get-PowerShellPath</a> now returns path for 64-bit PowerShell when running 32-bit PowerShell.</li>
</ul>

<h3 id="text">Text</h3>

<ul>
  <li>Created new <a href="http://get-carbon.org/help/ConvertTo-Base64.html">ConvertTo-Base64</a> function for encoding strings in base-64.</li>
  <li>Created new <a href="http://get-carbon.org/help/ConvertFrom-Base64.html">ConvertFrom-Base64</a> function for decoding base-64 strings.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="net">.NET</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-DotNetAppSetting.html">Set-DotNetAppSetting</a> and <a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString</a> weren&rsquo;t able to set .NET 2.0 app settings and connections string when running under PowerShell 3.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/06/carbon-v12-released.html">Carbon v1.2 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-25T21:32:00-07:00" pubdate data-updated="true">Jun 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.2 is out, is <a href="http://semver.org">backwards compatible</a> with v1.0 and v1.1 and supports PowerShell 3.  (Future releases of Carbon will most likely <em>only</em> support PowerShell 3.)  This release features mostly new functionality, including new functions for managing NTFS compression and performing XDT transformations.  Thanks to Mark Sargent and Philip Teilmeier for contributing enhancements.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>Carbon now works under PowerShell v3.0!</li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Added support for IPv6 addresses to <a href="http://get-carbon.org/help/Get-SslCertificateBinding.html">Get-SslCertificateBinding</a>, <a href="http://get-carbon.org/help/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a>, and <a href="http://get-carbon.org/help/Set-SslCertificateBinding.html">Set-SslCertificateBinding</a>.</li>
</ul>

<h3 id="net">.NET</h3>

<ul>
  <li>Added <code>ProviderName</code> parameter to <a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString </a> for setting a connection string&rsquo;s <code>providerName</code> attribute/value.</li>
</ul>

<h3 id="file-system">File System</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Disable-NtfsCompression.html">Disable-NtfsCompression</a> function for disabling NTFS compression on files/directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Enable-NtfsCompression.html">Enable-NtfsCompression</a> function for enabling NTFS compression on files/directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-NtfsCompression.html">Test-NtfsCompression</a> function for testing if NTFS compression is enabled on a file/directory.</li>
</ul>

<h3 id="iis">IIS</h3>
<ul>
  <li>The <a href="http://msdn.microsoft.com/en-us/library/microsoft.web.administration.site.aspx">site object</a> returned by <a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a> now as a <code>CommitChanges</code> method so you can persist modifications you make to the site.</li>
  <li><a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a> now returns all websites if no <code>SiteName</code> is given.</li>
  <li>Created <a href="http://get-carbon.org/help/Set-IisWebsiteID.html">Set-IisWebsiteID</a> function for explicitly setting a website&rsquo;s ID.</li>
</ul>

<h3 id="ini">INI</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Remove-IniEntry.html">Remove-IniEntry</a> function for removing entries/settings from an INI file.</li>
</ul>

<h3 id="performance-counters">Performance Counters</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a> now supports installing a base performance counter.  Thanks to Philip Teilmeier for the contribution.</li>
  <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a>&rsquo;s <code>Description</code> parameter is now optional.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now defaults to running under the current CLR, instead of defaulting to a v2.0 CLR.  This makes upgrading to PowerShell v3.0 easier.</li>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now writes an error and returns if running PowerShell v3.0 and you want to run under a v2.0 CLR.  Unfortunately, PowerShell v3.0 requires .NET 4.0, so you can&rsquo;t run anything on an earlier CLR.</li>
</ul>

<h3 id="privileges">Privileges</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a> now supports case-insensitive privilege names.</li>
  <li>Updated <a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> to better handle when passing a privilege name with the wrong case.</li>
  <li>Updated <a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> documentation to make it clear privilege names are case-sensitive.</li>
</ul>

<h3 id="xml">XML</h3>

<ul>
  <li>New <a href="http://get-carbon.org/help/Convert-XmlFile.html">Convert-XmlFile</a>, for transforming an XML file with Microsoft&rsquo;s XDT (XML Data Transformation) technology.  Thanks to Mark Sargent for the contribution.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="general-1">General</h3>

<ul>
  <li>Deleted the obsolete variable <code>$CarbonImported</code>.  Carbon no longer exports any of its variables.</li>
</ul>

<h3 id="certificates-1">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-SslCertificateBinding.html">Get-SslCertificateBinding</a> can&rsquo;t parse bindings to IPv6 addresses.</li>
</ul>

<h3 id="performance-counters-1">Performance Counters</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a> couldn&rsquo;t be used to create counters that used/required a base counter. Thanks to Philip Teilmeier for the contribution.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/06/desired-state-configuration-with-powershell.html">Desired State Configuration With PowerShell</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-13T13:17:00-07:00" pubdate data-updated="true">Jun 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I recommend finding time to watch Jeffrey Snover and Kenneth Hansen&rsquo;s <a href="http://channel9.msdn.com/Events/TechEd/NorthAmerica/2013/MDC-B302">Desired State Configuration in Windows Server 2012 R2 PowerShell</a> talk from TechEd 2013.  Desired State Configuration is a way of specifying, via new PowerShell language features, how you want a server to get setup and configured.  PowerShell then takes that configuration data, and applies it on the server or servers of your choice. It looks like a great piece of technology.  </p>

<p>Remember, <em>keep your configuration and your scripts separate</em>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/25/who-is-modifying-that-file.html">Who Is Modifying That File?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T14:51:00-07:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Raymond Chen recently explained <a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/04/18/10412074.aspx">how to turn on file system auditing</a> in Windows, which will help you figure out <strong>who keeps modifiying that file</strong>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/25/serilog.html">Serilog</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T14:43:00-07:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I like the idea behind the new <a href="http://nblumhardt.com/2013/03/serilog/">Serilog</a> .NET logging framework: instead of logging strings, you actually log objects.  Cool idea.  The code is <a href="https://github.com/nblumhardt/serilog">hosted on Github</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/1/carbon-v11-released.html">Carbon v1.1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-01T13:32:00-07:00" pubdate data-updated="true">Apr 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Carbon v1.1 is out. It is <a href="http://semver.org">backwards-compatible</a> with v1.0.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket</a>.</p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<ul>
  <li>On Windows 2008 R2, custom identies that run IIS app pools need the <code>SeBatchLogonRight</code>.  <a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> now grants this privilege on all operating systems.  If this won&rsquo;t work in your environment, you can remove these privileges with <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a>.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>Fixed some typos and ommissions in the v0.5.0.1 and v0.5.0.0 sections of the release notes.</li>
  <li>Updated <code>Import-Carbon.ps1</code> script to import Carbon regardless of the name of the directory Carbon is installed in.</li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Added <code>IssuedTo</code> and <code>IssuedBy</code> properties to <a href="http://msdn.microsoft.com/en-us/library/ms148409.aspx">X509Certificate2</a> objects.  The values match what the Certificates MMC snap-in displays.</li>
  <li>Added <code>DisplayName</code> property to <a href="http://msdn.microsoft.com/en-us/library/d228271e.aspx">X509Store</a> objects, to show the names of the stores as they are displayed in the Certificates MMC snap-in.</li>
</ul>

<h3 id="computer">Computer</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Resolve-NetPath.html">Resolve-NetPath</a> for getting the path to the Windows <code>net.exe</code> command/application.  Updated all functions that call <code>net.exe</code> to use this function to resolve its path.  Thanks to Paul Aage Aasheim for discovering that when running login scripts, <code>net.exe</code> isn&rsquo;t in the path.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-IisHttpHeader.html">Get-IisHttpHeader</a> for getting the custom HTTP headers for a website or one of its sub-directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Set-IisHttpHeader.html">Set-IisHttpHeader</a> for creating/setting a custom HTTP header for a website or one of its sub-directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisMimeMap.html">Get-IisMimeMap</a> for getting the file extension to MIME type mappings for the IIS web server.</li>
  <li>Created <a href="http://get-carbon.org/help/Remove-IisMimeMap.html">Remove-IisMimeMap</a> for removing a file extension to MIME type mapping for the IIS web server.</li>
  <li>Created <a href="http://get-carbon.org/help/Set-IisMimeMap.html">Set-IisMimeMap</a> for creating/setting a file extension to MIME type mapping for the IIS web server.</li>
  <li>When creating an app pool that runs under a custom, non-service account, <a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> grants that user the <code>SeBatchLogonRight</code>.</li>
  <li><a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> writes an error if its user account doesn&rsquo;t exist (i.e. if the value of the <code>Username</code> parameter doesn&rsquo;t exist).</li>
</ul>

<h3 id="privileges">Privileges</h3>

<ul>
  <li>Improved exception handling in <a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> and <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a>.</li>
  <li><a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> and <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a> now write an error message if an identity doesn&rsquo;t exist.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="computer-1">Computer</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> can&rsquo;t find <code>net.exe</code> when running as part of a Windows logon script.  Thanks to Paul Aage Aasheim for identifying and reporting this bug.  All usages of the <code>net.exe</code> application were updated to use the new <a href="http://get-carbon.org/help/Resolve-NetPath.html">Resolve-NetPath</a> function, which get the path to <code>net.exe</code> without assuming it is in the user&rsquo;s <code>PATH</code> environment variable.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> no longer writes an error if it can&rsquo;t find a fully-qualified local user, e.g. <code>$env:COMPUTERNAME\Username</code>.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/29/stupid-feed-tricks.html">Stupid Feed Tricks</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-29T03:58:00-07:00" pubdate data-updated="true">Mar 29<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://inessential.com/2013/03/18/brians_stupid_feed_tricks">Brent Simmons, who goes on to quote Brian Reischl:</a></p>

<blockquote>
  <p>At NewsGator and Sepia Labs I worked with Brian Reischl, one of the server-side guys. Among other things, he worked on NewsGator’s RSS content service, which reads n million feeds once an hour.</p>
</blockquote>

<blockquote>
  <p>(I don’t know if I can say what n is. It surprised me when I heard it. The system is still running, by the way.)</p>
</blockquote>

<blockquote>
  <p>Brian is intimately acquainted with the different ways feeds can be screwed up. So he posted <a href="https://docs.google.com/document/d/1cvq67iQpk2C7ufOsefsfKnGCXeUIv46NQHbnHkm8PtU/edit?usp=sharing">Stupid Feed Tricks</a> on Google Docs.</p>
</blockquote>

<blockquote>
  <p>I quote the entire thing below for people like me who don’t have Google accounts. The below is all by Brian:</p>
</blockquote>

<p>He then goes on to list several dozen edge cases the feed reader had to handle. </p>

<p><strong>Writing software is hard.</strong></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/25/powershell-check-if-processes-are-waiting-and-prompting-for.html">PowerShell: Check if Processes Are Waiting and Prompting for User Input</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-25T13:13:00-07:00" pubdate data-updated="true">Mar 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m currently writing a PowerShell script that will commit changes to a <a href="http://mercurial.selenic.com">Mercurial</a> repository, then push those changes out to our central Mercurial server.  If there are new changes on the server, the script will need to pull those changes down before it pushes, merge them, commit the merge, then re-push to the server.  Rinse and repeat until the push succeeds.  Because it will run under our continuous integration build server, it needs to be able to run headless (i.e., non-interactively).</p>

<p>During a merge, Mercurial will sometimes prompt the user for input (e.g. if a file was deleted by someone, but modified by someone else, Mercurial asks if you want to keep the change or keep the deletion).  Prompting for input won&rsquo;t work under a continuous integration server because no one&rsquo;s around to answer.  So, my script needs to detect when Mercurial is prompting for input, kill it, then notify those responsible that manual intervention is necessary.</p>

<p>Google turned up <em><a href="http://stackoverflow.com/questions/1704791/is-my-process-waiting-for-input">Is My Process Waiting for Input?</a></em> on StackOverflow.  The .NET <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx">System.Net.Diagnostics.Process</a> class has a <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.process.threads.aspx">Threads</a> property, which is a collection of <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.aspx">ProcessThread</a> objects.  If a process is waiting for input, one of its threads will be in a wait state (i.e. its <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.threadstate.aspx">ThreadState</a> property will be <code>Wait</code>), waiting for user input (i.e., its <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.waitreason.aspx">WaitReason</a> property will be <code>LpcReply</code>).</p>

<p>So, to get all process in PowerShell that are waiting for user input, you can do something like this:</p>

<pre><code>Get-Process | Where-Object { 
    Select-Object -ExpandProperty Threads | 
        Where-Object { $_.ThreadState -eq 'Wait' -and $_.WaitReason -eq 'LpcReply' }
}
</code></pre>

<p>Of course, this is the easy part.  Here&rsquo;s my final script.  In addition to using <code>Start-Process</code> to start the merge so we can monitor the process while its running, it redirects STDOUT and STDERR to files, so we can see it in our build log.</p>

<pre><code># Create some files for storing STDOUT and STDERR streams
$randomFileName = [IO.Path]::GetRandomFileName()

$stdOutFile = 'hg.merge.StdOut.{0}' -f $randomFileName
$stdOutFile = Join-Path $env:Temp $stdOutFile

$stdErrFile = 'hg.merge.StdErr.{0}' -f $randomFileName
$stdErrFile = Join-Path $env:Temp $stdErrFile

# Start the merge.
$mergeProcess = Start-Process -FilePath hg.exe `
                              -ArgumentList 'merge','-r',$Revision `
                              -PassThru `
                              -NoNewWindow `
                              -RedirectStandardOutput $stdOutFile `
                              -RedirectStandardError $stdErrFile
try
{
    do
    {
        # If the merge every prompts the user for input, kill it.
        Start-Sleep -Milliseconds 100
        $waitingForInput = $mergeProcess.Threads | 
                                Where-Object { $_.ThreadState -eq 'Wait' -and $_.WaitReason -eq 'LpcReply' }
        if( $waitingForInput )
        {
            Write-Error -Message ('Stopping non-interactive merge: Mercurial is prompting for input.') `
                        -RecommendedAction 'Please merge manually.'
            $null = $mergeProcess | Stop-Process -PassThru | Wait-Process
            break
        }
    }
    while( -not $mergeProcess.HasExited )
    
    # Display STDOUT.
    Get-Content -Path $stdOutFile | Write-Host
    
    # Display STDERR
    # For some reason, it takes a little time to read the Standard Error file.
    $errors = $null
    $readFile = $false
    do
    {
        Start-Sleep -Milliseconds 100
        try
        {
            $errors = [IO.File]::ReadAllText($stdErrFile)
            $readFile = $true
        }
        catch
        {
        }
    }
    while( -not $readFile )
    
    if( $errors )
    {
        Write-Error -Message $errors
    }
    
}
finally
{
    # Clean up the temporary files used to capture STDOUT and STDERR
    ($stdOutFile,$stdErrFile) | Where-Object { Test-Path -Path $_ -PathType Leaf } | Remove-Item
}
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/3/">&larr; Older</a>
    
    <a href="/archive">Archive</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section style="margin-top:2em;">

	<p>
		<a href="http://twitter.com/pshdo"><img src="/storage/twitter.png" alt="" width="32" height="32" style="border:none;vertical-align:middle;" ></a>
		
		<a href="http://twitter.com/pshdo" >Follow on Twitter</a>
	</p>

</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2016/02/carbon-2.1.0-released.html">Carbon 2.1.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/carbon-2.0.1-released.html">Carbon 2.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/blade-0.15.0-released.html">Blade 0.15.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/carbon-2.0.0-released.html">Carbon 2.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/carbon-1.9.0-released.html">Carbon 1.9.0 Released</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Aaron Jensen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
