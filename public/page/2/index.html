
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>> pshdo</title>
  <meta name="author" content="Aaron Jensen">

  
  <meta name="description" content="Raymond Chen recently explained how to turn on file system auditing in Windows, which will help you figure out who keeps modifiying that file.
">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pshdo.com/page/2/index.html">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pshdo.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/archive/atom.xml" rel="alternate" title="> pshdo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">> pshdo</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/archive/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pshdo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
	<li><a href="/about">About</a></li>
	<li><a href="/archive">Archive</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/25/who-is-modifying-that-file.html">Who Is Modifying That File?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T14:51:00-07:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Raymond Chen recently explained <a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/04/18/10412074.aspx">how to turn on file system auditing</a> in Windows, which will help you figure out <strong>who keeps modifiying that file</strong>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/25/serilog.html">Serilog</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-25T14:43:00-07:00" pubdate data-updated="true">Apr 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I like the idea behind the new <a href="http://nblumhardt.com/2013/03/serilog/">Serilog</a> .NET logging framework: instead of logging strings, you actually log objects.  Cool idea.  The code is <a href="https://github.com/nblumhardt/serilog">hosted on Github</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/4/1/carbon-v11-released.html">Carbon v1.1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-01T13:32:00-07:00" pubdate data-updated="true">Apr 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Carbon v1.1 is out. It is <a href="http://semver.org">backwards-compatible</a> with v1.0.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket</a>.</p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<ul>
  <li>On Windows 2008 R2, custom identies that run IIS app pools need the <code>SeBatchLogonRight</code>.  <a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> now grants this privilege on all operating systems.  If this won’t work in your environment, you can remove these privileges with <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a>.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>Fixed some typos and ommissions in the v0.5.0.1 and v0.5.0.0 sections of the release notes.</li>
  <li>Updated <code>Import-Carbon.ps1</code> script to import Carbon regardless of the name of the directory Carbon is installed in.</li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Added <code>IssuedTo</code> and <code>IssuedBy</code> properties to <a href="http://msdn.microsoft.com/en-us/library/ms148409.aspx">X509Certificate2</a> objects.  The values match what the Certificates MMC snap-in displays.</li>
  <li>Added <code>DisplayName</code> property to <a href="http://msdn.microsoft.com/en-us/library/d228271e.aspx">X509Store</a> objects, to show the names of the stores as they are displayed in the Certificates MMC snap-in.</li>
</ul>

<h3 id="computer">Computer</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Resolve-NetPath.html">Resolve-NetPath</a> for getting the path to the Windows <code>net.exe</code> command/application.  Updated all functions that call <code>net.exe</code> to use this function to resolve its path.  Thanks to Paul Aage Aasheim for discovering that when running login scripts, <code>net.exe</code> isn’t in the path.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-IisHttpHeader.html">Get-IisHttpHeader</a> for getting the custom HTTP headers for a website or one of its sub-directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Set-IisHttpHeader.html">Set-IisHttpHeader</a> for creating/setting a custom HTTP header for a website or one of its sub-directories.</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisMimeMap.html">Get-IisMimeMap</a> for getting the file extension to MIME type mappings for the IIS web server.</li>
  <li>Created <a href="http://get-carbon.org/help/Remove-IisMimeMap.html">Remove-IisMimeMap</a> for removing a file extension to MIME type mapping for the IIS web server.</li>
  <li>Created <a href="http://get-carbon.org/help/Set-IisMimeMap.html">Set-IisMimeMap</a> for creating/setting a file extension to MIME type mapping for the IIS web server.</li>
  <li>When creating an app pool that runs under a custom, non-service account, <a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> grants that user the <code>SeBatchLogonRight</code>.</li>
  <li><a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> writes an error if its user account doesn’t exist (i.e. if the value of the <code>Username</code> parameter doesn’t exist).</li>
</ul>

<h3 id="privileges">Privileges</h3>

<ul>
  <li>Improved exception handling in <a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> and <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a>.</li>
  <li><a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a> and <a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a> now write an error message if an identity doesn’t exist.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="computer-1">Computer</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> can’t find <code>net.exe</code> when running as part of a Windows logon script.  Thanks to Paul Aage Aasheim for identifying and reporting this bug.  All usages of the <code>net.exe</code> application were updated to use the new <a href="http://get-carbon.org/help/Resolve-NetPath.html">Resolve-NetPath</a> function, which get the path to <code>net.exe</code> without assuming it is in the user’s <code>PATH</code> environment variable.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> no longer writes an error if it can’t find a fully-qualified local user, e.g. <code>$env:COMPUTERNAME\Username</code>.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/29/stupid-feed-tricks.html">Stupid Feed Tricks</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-29T03:58:00-07:00" pubdate data-updated="true">Mar 29<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://inessential.com/2013/03/18/brians_stupid_feed_tricks">Brent Simmons, who goes on to quote Brian Reischl:</a></p>

<blockquote>
  <p>At NewsGator and Sepia Labs I worked with Brian Reischl, one of the server-side guys. Among other things, he worked on NewsGator’s RSS content service, which reads n million feeds once an hour.</p>
</blockquote>

<blockquote>
  <p>(I don’t know if I can say what n is. It surprised me when I heard it. The system is still running, by the way.)</p>
</blockquote>

<blockquote>
  <p>Brian is intimately acquainted with the different ways feeds can be screwed up. So he posted <a href="https://docs.google.com/document/d/1cvq67iQpk2C7ufOsefsfKnGCXeUIv46NQHbnHkm8PtU/edit?usp=sharing">Stupid Feed Tricks</a> on Google Docs.</p>
</blockquote>

<blockquote>
  <p>I quote the entire thing below for people like me who don’t have Google accounts. The below is all by Brian:</p>
</blockquote>

<p>He then goes on to list several dozen edge cases the feed reader had to handle. </p>

<p><strong>Writing software is hard.</strong></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/25/powershell-check-if-processes-are-waiting-and-prompting-for.html">PowerShell: Check if Processes Are Waiting and Prompting for User Input</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-25T13:13:00-07:00" pubdate data-updated="true">Mar 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m currently writing a PowerShell script that will commit changes to a <a href="http://mercurial.selenic.com">Mercurial</a> repository, then push those changes out to our central Mercurial server.  If there are new changes on the server, the script will need to pull those changes down before it pushes, merge them, commit the merge, then re-push to the server.  Rinse and repeat until the push succeeds.  Because it will run under our continuous integration build server, it needs to be able to run headless (i.e., non-interactively).</p>

<p>During a merge, Mercurial will sometimes prompt the user for input (e.g. if a file was deleted by someone, but modified by someone else, Mercurial asks if you want to keep the change or keep the deletion).  Prompting for input won’t work under a continuous integration server because no one’s around to answer.  So, my script needs to detect when Mercurial is prompting for input, kill it, then notify those responsible that manual intervention is necessary.</p>

<p>Google turned up <em><a href="http://stackoverflow.com/questions/1704791/is-my-process-waiting-for-input">Is My Process Waiting for Input?</a></em> on StackOverflow.  The .NET <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx">System.Net.Diagnostics.Process</a> class has a <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.process.threads.aspx">Threads</a> property, which is a collection of <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.aspx">ProcessThread</a> objects.  If a process is waiting for input, one of its threads will be in a wait state (i.e. its <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.threadstate.aspx">ThreadState</a> property will be <code>Wait</code>), waiting for user input (i.e., its <a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.waitreason.aspx">WaitReason</a> property will be <code>LpcReply</code>).</p>

<p>So, to get all process in PowerShell that are waiting for user input, you can do something like this:</p>

<pre><code>Get-Process | Where-Object { 
    Select-Object -ExpandProperty Threads | 
        Where-Object { $_.ThreadState -eq 'Wait' -and $_.WaitReason -eq 'LpcReply' }
}
</code></pre>

<p>Of course, this is the easy part.  Here’s my final script.  In addition to using <code>Start-Process</code> to start the merge so we can monitor the process while its running, it redirects STDOUT and STDERR to files, so we can see it in our build log.</p>

<pre><code># Create some files for storing STDOUT and STDERR streams
$randomFileName = [IO.Path]::GetRandomFileName()

$stdOutFile = 'hg.merge.StdOut.{0}' -f $randomFileName
$stdOutFile = Join-Path $env:Temp $stdOutFile

$stdErrFile = 'hg.merge.StdErr.{0}' -f $randomFileName
$stdErrFile = Join-Path $env:Temp $stdErrFile

# Start the merge.
$mergeProcess = Start-Process -FilePath hg.exe `
                              -ArgumentList 'merge','-r',$Revision `
                              -PassThru `
                              -NoNewWindow `
                              -RedirectStandardOutput $stdOutFile `
                              -RedirectStandardError $stdErrFile
try
{
    do
    {
        # If the merge every prompts the user for input, kill it.
        Start-Sleep -Milliseconds 100
        $waitingForInput = $mergeProcess.Threads | 
                                Where-Object { $_.ThreadState -eq 'Wait' -and $_.WaitReason -eq 'LpcReply' }
        if( $waitingForInput )
        {
            Write-Error -Message ('Stopping non-interactive merge: Mercurial is prompting for input.') `
                        -RecommendedAction 'Please merge manually.'
            $null = $mergeProcess | Stop-Process -PassThru | Wait-Process
            break
        }
    }
    while( -not $mergeProcess.HasExited )
    
    # Display STDOUT.
    Get-Content -Path $stdOutFile | Write-Host
    
    # Display STDERR
    # For some reason, it takes a little time to read the Standard Error file.
    $errors = $null
    $readFile = $false
    do
    {
        Start-Sleep -Milliseconds 100
        try
        {
            $errors = [IO.File]::ReadAllText($stdErrFile)
            $readFile = $true
        }
        catch
        {
        }
    }
    while( -not $readFile )
    
    if( $errors )
    {
        Write-Error -Message $errors
    }
    
}
finally
{
    # Clean up the temporary files used to capture STDOUT and STDERR
    ($stdOutFile,$stdErrFile) | Where-Object { Test-Path -Path $_ -PathType Leaf } | Remove-Item
}
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/18/monitoring-windows-process-start-and-exit-events.html">Monitoring Windows Process Start and Exit Events</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-18T14:14:00-07:00" pubdate data-updated="true">Mar 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Part of my build server management responsibilities include trying to figure out why things are going wrong.  I don’t know about other environments, but our builds run a lot of processes. For example, we use <a href="http://technet.microsoft.com/en-us/library/cc733145.aspx">Robocopy</a> to individually deploy a website’s sub-directories.  When things go wrong, it’s hard to debug because these robocopy processes start and stop so quickly, I don’t have time to double-click them in <a href="http://technet.microsoft.com/en-us/sysinternals/bb896653">Process Explorer</a>. I usually resorted to adding lines in our deployment script to output the Robocopy command line and exit code, then running the build, waiting for it to finish, then inspecting the build logs.  </p>

<p><em>Ugh.</em></p>

<p>Last week, I discovered that <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx">Process Monitor</a> captures process start and exit events.  Just the information I need in these situations.</p>

<p>Open Process Monitor, and click the “Filter” button.</p>

<p><img src="/storage/screenshots/procmon/ProcessMonitorFilterButton.png" alt="" /></p>

<p>Create a new condition that matches when the <code>Operation</code> column contains the word <code>process</code> (don’t forget to click the <code>Add</code> button).</p>

<p><img src="/storage/screenshots/procmon/ProcessMonitorFilterOperationContainsProcess.png" alt="" /></p>

<p>Click OK and Process Monitor will start to show process start and exit events. Start events will show the parent process ID and command line used to start the program. Exit events will show the exit/return code and CPU/memory statistics.</p>

<p><img src="/storage/screenshots/procmon/ProcessMonitorProcessStartExitEvents.png" alt="" /></p>

<p>If you double-click the start event, you’ll be able to see the entire command line and all the process’s environment variables.</p>

<p>Thanks to the <a href="http://technet.microsoft.com/en-us/sysinternals/bb545021.aspx">Windows Sysinternals team</a> for the great tools.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/14/getting-x509certificate2s-issued-from-and-issued-to-properti.html">Getting X509Certificate2&#8217;s &#8220;Issued From&#8221; and &#8220;Issued to&#8221; Properties in PowerShell</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-14T14:36:00-07:00" pubdate data-updated="true">Mar 14<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of my problems with the <a href="http://msdn.microsoft.com/en-us/library/ms148409.aspx">X509Certificate2</a> object is that it doesn’t expose properties for the “Issued From” and “Issued To” data, properties which show by default when viewing certificates in the Windows Certificate MMC snap-in. This makes it difficult to match certificates you see the Certificates MMC with certificates you see in PowerShell.</p>

<p>Today I <a href="http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/a74e3465-7e36-43a9-a83a-fb28a629218f">discovered</a> the <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509certificate2.getnameinfo.aspx">GetNameInfo method</a>, which can return the “Issued To/By” text seen in the Certificates MMC snap-in:</p>

<pre><code>Get-ChildItem cert:\CurrentUser\My |
    Format-Table @{ Label = 'IssuedTo'; Expression = { $_.GetNameInfo( 'SimpleName', $false ) } },@{ Label = 'IssuedBy' ;Expression = { $_.GetNameInfo( 'SimpleName', $true ) } }
</code></pre>

<p>Here it is a little clearer:</p>

<pre><code>$cert.GetNameInfo( 'SimpleName', $false ) # This is IssuedTo.
$cert.GetNameInfo( 'SimpleName', $true )  # This is IssuedBy.
</code></pre>

<p>You could also pipe your certificates to <a href="http://technet.microsoft.com/en-us/library/hh849879.aspx">Add-Member</a>:</p>

<pre><code>Get-ChildItem cert:\CurrentUser\My |
    Add-Member ScriptProperty -Name IssuedTo -Value { $this.GetNameInfo( 'SimpleName', $false) } -PassThru |
    Add-Member ScriptProperty -Name IssuedBy -Value { $this.GetNameInfo( 'SimpleName', $true ) } -PassThru |
    Format-Table -Property IssuedTo,IssuedBy -AutoSize
</code></pre>

<p>The next version of <a href="http://get-carbon.org">Carbon</a> will add <code>IssuedBy</code> and <code>IssuedTo</code> properties to <code>X509Certificate2</code> objects, so you can do this instead:</p>

<pre><code>Get-ChildItem cert:\CurrentUser\My |
    Format-Table IssuedTo,IssuedBy -AutoSize
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/3/6/carbon-v100-released.html">Carbon v1.0.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-06T11:42:00-08:00" pubdate data-updated="true">Mar 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m extremely happy to announce the release of <a href="http://get-carbon.org">Carbon</a> v1.0.0.  Thanks to everyone who’s already started using Carbon.  Please continue to provide feedback.  I love to hear from everyone that’s using it, good or bad.  Also, now that we’re at v1.0, don’t hesitate to <strong>spread the word</strong>! </p>

<p>If you’re on v0.5.0.1, you should be able to upgrade with little or no work as this release is includes mostly fixes for bugs found in that release. </p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits here!</a> </p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<ul>
  <li>Remove the <code>Quiet</code> parameter from the <code>Import-Carbon.ps1</code> script.</li>
  <li>If you’re nesting Carbon as a sub-module of another module, <strong><em>STOP</em></strong>.  This causes havoc.  Create an <code>Import-*.ps1</code> script for your module which imports Carbon before importing your own module.  Update your scripts to import your module with your fancy new <code>Import-*.ps1</code> script.  See <a href="http://pshdo.com/archive/2012/6/4/best-practices-for-importing-powershell-modules.html">Best Practices for Importing PowerShell Modules</a> for details.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>The <code>Import-Carbon.ps1</code> script no longer checks if Carbon is a sub-module of another module, so the <code>Quiet</code> parameter was removed.  <strong><em>Please don’t nest Carbon in your modules!</em></strong>  It will cause havoc.</li>
  <li><code>Import-Carbon.ps1</code> will no longer stop execution if an error occurs during an import (i.e. the <code>$ErrorActionPreference = 'Stop'</code> line was removed).  </li>
</ul>

<h3 id="services">Services</h3>

<ul>
  <li>Renamed <a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a>’s <code>Dependencies</code> parameter to <code>Dependency</code> (with backwards-compatible alias), to follow PowerShell naming standards.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-User.html">Install-User</a>: you can now set a user’s full name with the optional <code>FullName</code> parameter.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="iis">IIS</h3>

<ul>
  <li>Added <code>Test-IisWebsiteExists</code> alias for <a href="http://get-carbon.org/help/Test-IisWebsite.html">Test-IisWebsite</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a> returns boolean values to the pipeline when clearing access rules.</li>
  <li>Added <code>Unprotect-AclAccessRules</code> alias for <a href="http://get-carbon.org/help/Protect-Acl.html">Protect-Acl</a>, for backwards-compatibility with earlier releases.</li>
  <li>Updated v0.5.0.0 section of release notes to include a note that <code>Unprotect-AclAccessRules</code> was renamed to <a href="http://get-carbon.org/help/Protect-Acl.html">Protect-Acl</a>.</li>
</ul>

<h3 id="service">Service</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> fails if <code>Dependency</code> parameter doesn’t have a value.  Sometimes.</li>
</ul>

<h3 id="shares">Shares</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> fails if a principal name contains a space.</li>
</ul>

<h3 id="users-and-groups-1">Users and Groups</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Add-GroupMember.html">Add-GroupMember</a> doesn’t handle when the .NET Active Directory throws an exception when adding members to a group, causing script termination.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/1/9/carbon-v0501.html">Carbon v0.5.0.1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-09T00:21:00-08:00" pubdate data-updated="true">Jan 9<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>OK.  The guilt was too overwhelming.  I’ve released Carbon v0.5.0.1, which adds a bunch of aliases for the functions renamed in v0.5.0.0.  This should make upgrading from previous releases easier.  </p>

<p>I’ve also renamed all functions with plural nouns in their names to use singular nouns instead, to better conform with <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd878270(v=vs.85).aspx#SD01">PowerShell standards</a>. But don’t worry, I’ve learned my lesson!  There are aliases in place for all name changes so you won’t have to change any of your exising scripts.  This is a 100% backwards-compatible release with v0.5.0.0. (Thanks to <a href="http://codeassassin.com">Jason Stangroome</a> for the feedback!)  </p>

<p><a href="http://bitbucket.org/splatteredbits/carbon/downloads">Go get it</a> and please keep the feedback coming.</p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="active-directory">Active Directory</h3>

<ul>
  <li>Renamed <code>Format-ADSpecialCharacters</code> to <a href="http://get-carbon.org/help/Format-ADSearchFilterValue.html">Format-ADSearchFilterValue</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Renamed <code>Get-SslCertificateBindings</code> to <a href="http://get-carbon.org/help/Get-SslCertificateBinding.html">Get-SslCertificateBinding</a>, with backwards-compatible alias.</li>
  <li>Added <code>Remove-Certificate</code> alias for <a href="http://get-carbon.org/help/Uninstall-Certificate.html">Uninstall-Certificate</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="com">COM</h3>

<ul>
  <li>Renamed <code>Get-ComPermissions</code> to <a href="http://get-carbon.org/help/Get-ComPermission.html">Get-ComPermission</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Grant-ComPermissions</code> to <a href="http://get-carbon.org/help/Grant-ComPermission.html">Grant-ComPermission</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Revoke-ComPermissions</code> to <a href="http://get-carbon.org/help/Revoke-ComPermission.html">Revoke-ComPermission</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="firewall">Firewall</h3>

<ul>
  <li>Renamed <code>Get-FirewallRules</code> to <a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Renamed <code>Add-IisServerManagerMembers</code> to <a href="http://get-carbon.org/help/Add-IisServerManagerMember.html">Add-IisServerManagerMember</a>, with backwards-compatible alias.</li>
  <li>Added <code>StatusCode</code> alias for <a href="http://get-carbon.org/help/Set-IisHttpRedirect.html">Set-IisHttpRedirect’s</a> <code>HttpResponseStatus</code> parameter, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Test-IisAppPoolExists</code> alias for <a href="http://get-carbon.org/help/Test-IisAppPool.html">Test-IisAppPool</a>, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Remove-IisWebsite</code> alias for <a href="http://get-carbon.org/help/Uninstall-IisWebsite.html">Uninstall-IisWebsite</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="internet-explorer">Internet Explorer</h3>

<ul>
  <li>Renamed <code>Enable-IEActivationPermissions</code> to <a href="http://get-carbon.org/help/Enable-IEActivationPermission.html">Enable-IEActivationPermission</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="msmq">MSMQ</h3>

<ul>
  <li>Renamed <code>Grant-MsmqMessageQueuePermissions</code> to <a href="http://get-carbon.org/help/Grant-MsmqMessageQueuePermission.html">Grant-MsmqMessageQueuePermission</a>, with backwards-compatible alias.</li>
  <li>Added <code>Remove-MsmqMessageQueue</code> alias for <a href="http://get-carbon.org/help/Uninstall-MsmqMessageQueue.html">Uninstall-MsmqMessageQueue</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="path">Path</h3>

<ul>
  <li>Added <code>ConvertTo-FullPath</code> alias for <a href="http://get-carbon.org/help/Resolve-FullPath.html">Resolve-FullPath</a>, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Get-PathCanonicalCase</code> alias for <a href="http://get-carbon.org/help/Resolve-PathCase.html">Resolve-PathCase</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="performance-counters">Performance Counters</h3>

<ul>
  <li>Renamed <code>Get-PerformanceCounters</code> to <a href="http://get-carbon.org/help/Get-PerformanceCounter.html">Get-PerformanceCounter</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li>Renamed <code>Add-TrustedHosts</code> to <a href="http://get-carbon.org/help/Add-TrustedHost.html">Add-TrustedHost</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Add-TrustedHost</code>’s <code>Entries</code> parameter to <code>Entry</code>, with backwards-compatible alias.</li>
  <li>Renamed <code>Clear-TrustedHosts</code> to <a href="http://get-carbon.org/help/Clear-TrustedHost.html">Clear-TrustedHost</a>, with backwards-compatible alias. </li>
  <li>Renamed <code>Complete-Jobs</code> to <a href="http://get-carbon.org/help/Complete-Job.html">Complete-Job</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Complete-Job</code>’s <code>Jobs</code> parameter to <code>Job</code>, with backwards-compatible alias.</li>
  <li>Renamed <code>Get-TrustedHosts</code> to <a href="http://get-carbon.org/help/Get-TrustedHost.html">Get-TrustedHost</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Set-TrustedHosts</code> to <a href="http://get-carbon.org/help/Set-TrustedHost.html">Set-TrustedHost</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Set-TrustedHost</code>’s <code>Entries</code> parameter to <code>Entry</code>, with backwards-compatible alias.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li>Renamed <code>Assert-AdminPrivileges</code> to <a href="http://get-carbon.org/help/Assert-AdminPrivilege.html">Assert-AdminPrivilege</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>ConvertTo-InheritanceFlags</code> to <a href="http://get-carbon.org/help/ConvertTo-InheritanceFlag.html">ConvertTo-InheritanceFlag</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>ConvertTo-InheritanceFlag</code>’s <code>ContainerInheritanceFlags</code> parameter to <code>ConvertTo-InheritanceFlag</code>, with backwards-compatible alias.</li>
  <li>Renamed <code>ConvertTo-PropagationFlags</code> to <a href="http://get-carbon.org/help/ConvertTo-PropagationFlag.html">ConvertTo-PropagationFlag</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>ConvertTo-PropagationFlag</code>’s <code>ContainerInheritanceFlags</code> parameter to <code>ConvertTo-InheritanceFlag</code>, with backwards-compatible alias.</li>
  <li>Renamed <code>Get-Permissions</code> to <a href="http://get-carbon.org/help/Get-Permission.html">Get-Permission</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Grant-Permissions</code> to <a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Grant-Permission</code>’s <code>Permissions</code> parameter to <code>Permission</code>, with backwards-compatible alias.</li>
  <li>Renamed <code>Test-AdminPrivileges</code> to <a href="http://get-carbon.org/help/Test-AdminPrivilege.html">Test-AdminPrivilege</a>, with backwards-compatible alias.</li>
</ul>

<h3 id="service">Service</h3>

<ul>
  <li>Renamed <code>Get-ServicePermissions</code> to <a href="http://get-carbon.org/help/Get-ServicePermission.html">Get-ServicePermission</a>, with backwards-compatible alias.</li>
  <li>Added <code>Remove-Service</code> alias for <a href="http://get-carbon.org/help/Uninstall-Service.html">Uninstall-Service</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li>Renamed <code>Add-GroupMembers</code> to <a href="http://get-carbon.org/help/Add-GroupMember.html">Add-GroupMember</a>, with backwards-compatible alias.</li>
  <li>Renamed <code>Add-GroupMember</code>’s <code>Members</code> parameter to <code>Member</code>.</li>
  <li>Added <code>Remove-User</code> alias for <a href="http://get-carbon.org/help/Uninstall-User.html">Uninstall-User</a>, for backwards-compatibility with earlier releases.</li>
</ul>

<h3 id="windows-features">Windows Features</h3>

<ul>
  <li>Added <code>Install-WindowsFeatures</code> alias for <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Features</code> alias for  <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature’s</a> <code>Name</code> parameter, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Uninstall-WindowsFeatures</code> alias for <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a>, for backwards-compatibility with earlier releases.</li>
  <li>Added <code>Features</code> alias for  <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature’s</a> <code>Name</code> parameter, for backwards-compatibility with earlier releases.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2013/1/7/carbon-v0500.html">Carbon v0.5.0.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-07T22:15:00-08:00" pubdate data-updated="true">Jan 7<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’m extremely happy to announce Carbon v0.5.0.0.  This should be the last release of Carbon before v1.0, which will probably be released in late February or early March.  This is the most stable version of Carbon yet, and should be considered a beta of version 1.0.</p>

<p>In order to stabilize the API, make it internally consistent, and improve future maintainability, this release contains many backwards incompatible changes.  We apologize for this inconvenience.  API stability will be a high priority once v1.0 is out the door. </p>

<p>Please take some time within the next few weeks to <a href="http://bitbucket.org/splatteredbits/carbon/downloads">download Carbon</a>, and see how it works for you.  If you notice any problems or have any suggestions, <a href="https://bitbucket.org/splatteredbits/carbon/issues">please file a bug report</a>.  Help us make Carbon even better!</p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<p>Take the following steps to get your scripts to work with this release.</p>

<h3 id="certificates">Certificates</h3>

<p>Replaces usages of:</p>

<ul>
  <li><code>Get-SslCertificateBinding</code> with <code>Get-SslCertificateBindings</code></li>
  <li><code>Get-SslCertificateBinding -IPPort '0.0.0.0:443'</code> with <code>Get-SslCertificateBindings</code></li>
  <li><code>Get-SslCertificateBinding -IPPort '10.1.1.1:8001</code> with <code>Get-SslCertificateBindings -IPAddress '10.1.1.1' -Port 8001</code></li>
  <li><code>Test-SslCertificateBinding -IPPort '0.0.0.0:443</code> with <code>Test-SslCertificateBinding</code></li>
  <li><code>Test-SslCertificateBinding -IPPort '10.1.1.1:8001</code> with <code>Test-SslCertificateBinding -IPAddress '10.1.1.1' -Port 8001</code></li>
  <li><code>Set-SslCertificateBinding -IPPort '0.0.0.0:443</code> with <code>Set-SslCertificateBinding</code></li>
  <li><code>Set-SslCertificateBinding -IPort '1.2.3.4:8001' with </code>Set-SslCertificateBinding -IPAddress ‘1.2.3.4’ -Port 8001</li>
  <li><code>Remove-SslCertificateBinding -IPPort '0.0.0.0:443</code> with <code>Remove-SslCertificateBinding</code></li>
  <li><code>Remove-SslCertificateBinding -IPPort '10.1.1.1:8001</code> with <code>Remove-SslCertificateBinding -IPAddress '10.1.1.1' -Port 8001</code></li>
</ul>

<h3 id="computer">Computer</h3>

<p>Replace usages of</p>

<ul>
  <li><code>Set-EnvironmentVariable -Scope 'Process'</code> with <code>Set-EnvironmentVariable -ForProcess</code></li>
  <li><code>Set-EnvironmentVariable -Scope 'User'</code> with <code>Set-EnvironmentVariable -ForUser</code></li>
  <li><code>Set-EnvironmentVariable -Scope 'ForComputer'</code> with <code>Set-EnvironmentVariable -ForComputer</code></li>
</ul>

<h3 id="cryptography">Cryptography</h3>

<ul>
  <li><code>Protect-String -Scope CurrentUser</code> with <code>Protect-String -ForUser</code></li>
  <li><code>Protect-String -Scope LocalMachine</code> with <code>Protect-String -ForComputer</code></li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Renamed the <code>StatusCode</code> property on the object returned by <a href="http://get-carbon.org/help/Get-IisHttpRedirect.html">Get-IisHttpRedirect</a> to <code>HttpResponseStatus</code>.  Update usages accordingly.</li>
  <li>The <code>Bindings</code> property returned by <code>Get-IisWebsite</code> is now a collection of <code>Microsoft.Web.Administration.Binding</code> objects.  Update usages of <code>$site.Bindings[$idx].IPAddress</code> and <code>$site.Bindings[$idx].Port</code> to <code>$site.Bindings[$idx].Endpoint.Address</code> and <code>$site.Bindings[$idx].Endpoint.Port</code>, respectively.</li>
</ul>

<p>Replace usages of:</p>

<ul>
  <li><code>Set-IisAnonymousAuthentication</code> with <code>Enable-IisSecurityAuthentication -Anonymous</code> </li>
  <li><code>Set-IisAnonymousAuthentication -Disabled</code> with <code>Disable-IisSecurityAuthentication -Anonymous</code></li>
  <li><code>Set-IisBasicAuthentication</code> with <code>Enable-IisSecurityAuthentication -Basic</code></li>
  <li><code>Set-IisBasicAuthentication -Disabled</code> with <code>Disable-IisSecurityAuthentication -Basic</code></li>
  <li><code>Set-IisWindowsAuthentication</code> with <code>Enable-IisSecurityAuthentication -Windows</code> and <code>Set-IisWindowsAuthentication -DisableKernelMode</code></li>
  <li><code>Set-IisWindowsAuthentication -UseKernelMode</code> with <code>Set-IisWindowsAuthentication</code></li>
  <li><code>Set-IisWindowsAuthentication -Disabled</code> with <code>Disable-IisSecurityAuthentication -Windows</code>  </li>
  <li><code>Unlock-IisConfigSection -Name &lt;string&gt;</code> with <code>Unlock-IisConfigurationSection -SectionPath &lt;string&gt;</code> (run <code>appcmd.exe lock config -section:?</code> for values to the new <code>SectionPath</code> parameter)</li>
  <li><code>Unlock-IisBasicAuthentication</code> with <code>Unlock-IisConfigurationSeciton -SectionPath 'system.webServer/security/authentication/basicAuthentication'</code></li>
  <li><code>Unlock-IisCgi</code> with <code>Unlock-IisConfigurationSeciton -SectionPath 'system.webServer/cgi'</code></li>
  <li><code>Unlock-IisWindowsAuthentication</code> with <code>Unlock-IisConfigurationSeciton -SectionPath 'system.webServer/security/authentication/windowsAuthentication'</code></li>
</ul>

<h3 id="ini">INI</h3>

<p>Replace usages of:</p>

<ul>
  <li><code>Split-Ini -Path &lt;string&gt;</code> with <code>Split-Ini -Path &lt;string&gt; -AsHashtable</code> (hashtable is no longer returned by default)</li>
  <li><code>Split-Ini -Path &lt;string&gt; -PassThru</code> with <code>Split-Ini -Path &lt;string&gt;</code> (per-line objects are now returned by default)</li>
</ul>

<h3 id="path">Path</h3>

<p>Replace usages of</p>

<ul>
  <li><code>Get-PathRelativeTo -To &lt;string&gt; -From &lt;string&gt;'</code> with <code>Resolve-RelativePath -Path &lt;string&gt; -FromDirectory &lt;string&gt;</code></li>
  <li><code>Get-PathRelativeTo -To &lt;string&gt; -From &lt;string&gt; -FromType 'File'</code> with <code>Resolve-RelativePath -Path &lt;string&gt; -FromFile &lt;string&gt;</code></li>
</ul>

<h3 id="performance-counters">Performance Counters</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-PerformanceCounters.html">Get-PerformanceCounters</a> no longer returns an empty list if there are zero counters or a single element list if there is one counter.  It now returns <code>null</code> and a single object, respectively.  Update usages accordingly.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-TrustedHosts.html">Get-TrustedHosts</a> no longer returns an empty list if there are no trusted hosts.  It now return nothing/<code>null</code>.  Update usages accordingly.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Assert-AdminPrivileges.html">Assert-AdminPrivileges</a> now returns <code>True</code> or <code>False</code> if the user doesn’t have admin privileges. It also no longer throws an exception, but writes an error.  If you want to preserve current behavior where it stops script execution, replace usages with <code>Assert-AdminPrivileges -ErrorAction Stop</code>.</li>
</ul>

<h3 id="shares">Shares</h3>

<p>Replace usages of: </p>

<ul>
  <li><code>Install-Share -Permissions '"ShareAdmins,FULL"','"ShareWriters,CHANGE"','"ShareReaders,READ"'</code> with <code>Install-SmbShare -FullAccess ShareAdmins -ChangeAccess ShareWriters -ReadAccess ShareReaders</code>.</li>
</ul>

<h3 id="windows-features">Windows Features</h3>

<p>Replace usages of: </p>

<ul>
  <li><code>Test-WindowsFeature</code> with <code>Test-WindowsFeature -Installed</code></li>
  <li><code>Install-WindowsFeatureIis</code> with <code>Install-WindowsFeature -Iis</code></li>
  <li><code>Install-WindowsFeatureIis -HttpRedirection</code> with <code>Install-WindowsFeature -Iis -IisHttpRedirection</code></li>
  <li><code>Install-WindowsFeatureMsmq</code> with <code>Install-WindowsFeature -Msmq</code></li>
  <li><code>Install-WindowsFeatureMsmq -HttpSupport</code> with <code>Install-WindowsFeature -Msmq -MsmqHttpSupport</code></li>
  <li><code>Install-WindowsFeatureMsmq -ActiveDirectoryIntegration</code> with <code>Install-WindowsFeature -MsmqActiveDirectoryIntegration</code></li>
</ul>

<h2 id="new-features">New Features</h2>

<h3 id="iis-1">IIS</h3>
<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-IisConfigurationSection.html">Get-IisConfigurationSection</a> function for getting a site’s (and optional sub-directory’s) <a href="http://msdn.microsoft.com/en-us/library/microsoft.web.administration.configurationsection(v=vs.90).aspx">Microsoft.Web.Administration.ConfigurationSection</a> objects for an arbitrary IIS configuration section.</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisSecurityAuthentication.html">Get-IisSecurityAuthentication</a> function for getting a site’s (and optional sub-directory’s)  <a href="http://msdn.microsoft.com/en-us/library/microsoft.web.administration.configurationsection(v=vs.90).aspx">anonymous, basic, digest, or Windows authentication configuration section</a>.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-IisSecurityAuthentication.html">Test-IisSecurityAuthentication</a> function for testing if anonymous, basic, digest, or Windows authentication is enabled for a website (and optional sub-directory).</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisConfigurationSection.html">Get-IisConfigurationSection</a> function for returning an arbitrary IIS configuration section using the Microsoft.Web.Administration API.</li>
  <li>Created <a href="http://get-carbon.org/help/Lock-IisConfigurationSection.html">Lock-IisConfigurationSection</a> function for locking arbitrary global IIS configuration sections.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-IisConfigurationSection.html">Test-IisConfigurationSection</a> function for testing if an configuration section exists or is locked or not.</li>
  <li>Created function <a href="http://get-carbon.org/help/Get-IisAppPool.html">Get-IisAppPool</a> for getting a <code>Microsoft.Web.Administration.AppPool</code> object for an application pool.</li>
  <li>Created function <a href="http://get-carbon.org/help/Uninstall-IisAppPool.html">Uninstall-IisAppPool</a> for removing an IIS application pool.</li>
</ul>

<h3 id="windows-features-1">Windows Features</h3>
<ul>
  <li>Created new <a href="http://get-carbon.org/help/Get-WindowsFeature.html">Get-WindowsFeature</a> function for getting a list of available Windows features.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="service">Service</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> not granting default service identity, Network Service, the correct permissions.</li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> not correctly resolving local identity account names.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="certificates-1">Certificates</h3>
<ul>
  <li>Moved functionality of <code>Get-SslCertificateBinding</code> into <a href="http://get-carbon.org/help/Get-SslCertificateBindings.html">Get-SslCertificateBindings</a>.  Can now filter by <code>IPAddress</code> and/or <code>Port</code>.</li>
  <li><a href="http://get-carbon.org/help/Get-SslCertificateBindings.html">Get-SslCertificateBindings</a> now returns <code>Carbon.Certificates.SslCertificateBinding</code> objects.  All information displayed by the <code>netsh http show sslcert</code> command is returned as part of those objects.</li>
  <li><a href="http://get-carbon.org/help/Get-SslCertificateBindings.html">Get-SslCertificateBindings</a> now supports filtering by <code>IPAddress</code> and <code>Port</code> separately, instead of requiring both.  The old <code>IPPort</code> parameter is replaced with <code>IPAddress</code> and <code>Port</code> parameters.</li>
  <li><a href="http://get-carbon.org/help/Test-SslCertificateBinding.html">Test-SslCertificateBinding</a> now supports testig by <code>IPAddress</code> and <code>Port</code> separately, instead of requiring both.  The old <code>IPPort</code> parameter is replaced with <code>IPAddress</code> and <code>Port</code> parameters. </li>
  <li>Replaced <code>IPPort</code> parameter on <code>Get-SslCertificateBinding</code> with separate <code>IPAddress</code> and <code>Port</code> parameters on  <a href="http://get-carbon.org/help/Get-SslCertificateBindings.html">Get-SslCertificateBindings</a>.  Set <code>IPAddress</code> only if you want to bind to a specific IP address (i.e. <em>not</em> 0.0.0.0).  Set <code>Port</code> if <em>not</em> binding to port 443.</li>
  <li>Replaced <code>IPPort</code> parameter on <a href="http://get-carbon.org/help/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a> with separate <code>IPAddress</code> and <code>Port</code> parameters.  Set <code>IPAddress</code> only if you want to remove a binding for a specific IP address (i.e. <em>not</em> 0.0.0.0).  Set <code>Port</code> if the binding is <em>not</em> on port 443.</li>
  <li>Renamed <code>Remove-Certificate</code> to <a href="http://get-carbon.org/help/Uninstall-Certificate.html">Uninstall-Certificate</a> (added backwards-compatible alias in v0.5.0.1).</li>
</ul>

<h3 id="computer-1">Computer</h3>
<ul>
  <li>Replaced the <code>Scope</code> parameter on <a href="http://get-carbon.org/help/Set-EnvironmentVariable.html">Set-EnvironmentVariable</a> and <a href="http://get-carbon.org/help/Remove-EnvironmentVariable.html">Remove-EnvironmentVariable</a> with scope-specific <code>ForProcess</code>, <code>ForUser</code>, and <code>ForComputer</code> switches.</li>
</ul>

<h3 id="cryptography-1">Cryptography</h3>
<ul>
  <li>Replaced <a href="http://get-carbon.org/help/Protect-String.html">Protect-String</a>’s <code>Scope</code> parameteter with the <code>ForUser</code> or <code>ForComputer</code> scope-specific switches.</li>
</ul>

<h3 id="hosts-file">Hosts File</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Set-HostsEntry.html">Set-HostsEntry</a> no longer throws an exception if the hosts file contains an invalid line.  Instead, a warning is written and the line is commented out.</li>
</ul>

<h3 id="ini-1">INI</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Split-Ini.html">Split-Ini</a> now returns strongly-typed <code>Carbon.Ini.IniNode</code> objects instead of hashtables.</li>
  <li>The line numbers returned by <a href="http://get-carbon.org/help/Split-Ini.html">Split-Ini</a> start at 1 instead of 0.</li>
  <li><a href="http://get-carbon.org/help/Split-Ini.html">Split-Ini</a> now returns name/value objects by default (the <code>PassThru</code> switch is no longer needed for this behaviro).  This makes it more PowerShell-y.  The old behavior of returning a <code>Hashtable</code> is available be using the new <code>AsHashtable</code> switch.</li>
</ul>

<h3 id="iis-2">IIS</h3>
<ul>
  <li>Replaced <code>Set-IisAnonymousAuthentication</code> with <a href="http://get-carbon.org/help/Enable-IisSecurityAuthentication.html">Enable-IisSecurityAuthentication</a> and <a href="http://get-carbon.org/help/Disable-IisSecurityAuthentication.html">Disable-IisSecurityAuthentication</a>.</li>
  <li>Replaced <code>Set-IisBasicAuthentication</code> with <a href="http://get-carbon.org/help/Enable-IisSecurityAuthentication.html">Enable-IisSecurityAuthentication</a> and <a href="http://get-carbon.org/help/Disable-IisSecurityAuthentication.html">Disable-IisSecurityAuthentication</a>.</li>
  <li>Moved code to enable/disable Windows authentication from <a href="http://get-carbon.org/help/Set-IisWindowsAuthentication.html">Set-IisWindowsAuthentication</a> to  <a href="http://get-carbon.org/help/Enable-IisSecurityAuthentication.html">Enable-IisSecurityAuthentication</a> and <a href="http://get-carbon.org/help/Disable-IisSecurityAuthentication.html">Disable-IisSecurityAuthentication</a>.</li>
  <li>Switched the default behavior of <a href="http://get-carbon.org/help/Set-IisWindowsAuthentication.html">Set-IisWindowsAuthentication</a> to enable kernel mode.  To disable kernel mode, use the <code>DisableKernelMode</code> switch.</li>
  <li>Renamed <code>Unlock-IisConfigSection</code> to <a href="http://get-carbon.org/help/Unlock-IisConfigurationSection.html">Unlock-IisConfigurationSection</a>.</li>
  <li>Removed <a href="http://get-carbon.org/help/Unlock-IisConfigurationSection.html">Unlock-IisConfigurationSection</a>’s <code>Name</code> parameter and replaced it with <code>SectionPath</code>, which takes a list of full path to the configuration section(s) to unlock.</li>
  <li>Removed <code>Unlock-IisBasicAuthentication</code> in favor of <code>Unlock-IisConfigurationSection -SectionPath 'system.webServer/security/authentication/basicAuthentication'</code>.</li>
  <li>Removed <code>Unlock-IisCgi</code> in favor of <code>Unlock-IisConfigurationSection -SectionPath 'system.webServer/cgi'</code>.</li>
  <li>Removed <code>Unlock-IisWindowsAuthentication</code> in favor of <code>Unlock-IisConfigurationSection -SectionPath 'system.webServer/security/authentication/windowsAuthentication'</code>.</li>
  <li>Renamed <code>Remove-Service</code> to <a href="http://get-carbon.org/help/Uninstall-Service.html">Uninstall-Service</a> (added backwards-compatible alias in v0.5.0.1).</li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> writes errors instead of throwing exceptions.</li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> grants <code>ReadAndExecute</code> file system permissions on the service executable to the service identity instead of <code>FullControl</code>.</li>
  <li>Improved <a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a>’s <code>WhatIf</code> support.</li>
  <li>Renamed <code>Test-IisAppPoolExists</code> to <a href="http://get-carbon.org/help/Uninstall-Service.html">Test-IisAppPool</a> (added backwards-compatible alias in v0.5.0.1).</li>
  <li>Renamed <code>Remove-IisWebsite</code> with <a href="http://get-carbon.org/help/Uninstall-IisWebsite.html">Uninstall-IisWebsite</a> (added backwards-compatible alias in v0.5.0.1).</li>
  <li><a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> now always sets the application pool to run as the system’s default application pool identity if the <code>ServiceAccount</code> parameter isn’t given.</li>
  <li><a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> now starts an IIS application pool if it is stoppped.</li>
  <li><a href="http://get-carbon.org/help/Get-IisHttpRedirect.html">Get-IisHttpRedirect</a> now returns a <code>Carbon.Iis.HttpRedirectConfigurationSection</code> object.  The <code>StatusCode</code> property on the old object is now named <code>HttpResponseStatus</code>.</li>
  <li>Renamed the <code>StatusCode</code> parameter on <a href="http://get-carbon.org/help/Set-IisHttpRedirect.html">Set-IisHttpRedirect</a> to <code>HttpResponseStatus</code> (added backwards-compatible alias in v0.5.0.1).</li>
  <li><a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a> now returns a <code>Microsoft.Web.Administration.Site</code> object.</li>
</ul>

<h3 id="msmq">MSMQ</h3>
<ul>
  <li>Renamed <code>Remove-MsmqMessageQueue</code> to <a href="http://get-carbon.org/help/Uninstall-MsmqMessageQueue.html">Uninstall-MsmqMessageQueue</a> (added backwards compatible alias in v0.5.0.1).</li>
</ul>

<h3 id="path-1">Path</h3>
<ul>
  <li>Renamed <code>Get-PathRelativeTo</code> to <a href="http://get-carbon.org/help/Resolve-RelativePath.html">Resolve-RelativePath</a>.  Renamed its <code>To</code> parameter to <code>Path</code>, and moved it to position 0.  Replaced/combined the <code>From</code> and <code>FromType</code> parameters with <code>FromDirectory</code> and <code>FromFile</code> parameters.</li>
  <li>Renamed <code>ConvertTo-FullPath</code> to <a href="http://get-carbon.org/help/Resolve-FullPath.html">Resolve-FullPath</a> (added backwards-compatible alias in v0.5.0.1).  Added support for converting unrooted paths using the current location.</li>
  <li>Renamed <code>Get-PathCanonicalCase</code> with <a href="http://get-carbon.org/help/Resolve-PathCase.html">Resolve-PathCase</a> (added backwards-compatible alias in v0.5.0.1).  Added support for piping in <code>Get-Item</code> and <code>Get-ChildItem</code> output, e.g. <code>Get-Item C:\WINDOWS | Resolve-PathCase</code> returns C:\Windows.</li>
</ul>

<h3 id="performance-counters-1">Performance Counters</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Get-PerformanceCounters.html">Get-PerformanceCounters</a> now returns nothing/<code>null</code> or a single object instead of an empty/single element array when there are no or one performance counters. </li>
  <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a> no longer re-installs a counter if a counter with its name, description, and type already exist.</li>
</ul>

<h3 id="powershell-1">PowerShell</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Get-TrustedHosts.html">Get-TrustedHosts</a> now returns nothing/<code>null</code> if there are no trusted hosts.  (It used to return an empty array.) </li>
</ul>

<h3 id="security-1">Security</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Assert-AdminPrivileges.html">Assert-AdminPrivileges</a> no longer throws an exception if the user doesn’t have administrative privileges.  Instead, it writes an error and returns <code>False</code>.  It returns <code>True</code> if the user has privileges.</li>
</ul>

<h3 id="shares-1">Shares</h3>
<ul>
  <li>Replaced the <code>Permissions</code> parameter on <a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> with <code>FullAccess</code>, <code>ChangeAccess</code>, and <code>ReadAccess</code> parameters. Previously, to set share permissions, you passed in specially-formatted values to the <code>Permission</code> parameter, e.g. <code>"MyGroup,FULL","MyOtherGroup,READ"</code>.  Now, just pass a list of identity name(s) to the <code>FullAccess</code>, <code>ChangeAccess</code>, or <code>ReadAccess</code> parameters to grant those identies full, change, or read access, e.g. <code>-FullAccess MyGroup -ReadAccess MyOtherGroup</code>.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>
<ul>
  <li>Renamed <code>Remove-User</code> to <a href="http://get-carbon.org/help/Uninstall-User.html">Uninstall-User</a> (added backwards-compatible alias in v0.5.0.1).</li>
</ul>

<h3 id="windows-features-2">Windows Features</h3>
<ul>
  <li><a href="http://get-carbon.org/help/Test-WindowsFeature.html">Test-WindowsFeature</a> now tests if a Windows feature exists, instead of if it is installed.  Added an <code>Installed</code> switch to detect if a feature exists <em>and</em> if it is installed.</li>
  <li>Renamed <code>Install-WindowsFeatures</code> to <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a> (added backwards-compatible alias in v0.5.0.1).</li>
  <li>Renamed <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>’s <code>Features</code> parameter to <code>Name</code> (added backwards-compatible alias in v0.5.0.1).</li>
  <li>Removed <code>Install-WindowsFeatureIis</code> and replaced with <code>Iis</code> and <code>IisHttpRedirection</code> switches on <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>.</li>
  <li>Removed <code>Install-WindowsFeatureMsmq</code> and replaced with <code>Msmq</code>, <code>MsmqHttpSupport</code>, and <code>MsmqActiveDirectoryIntegration</code> switches on <a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>.</li>
  <li>Renamed <code>Uninstall-WindowsFeatures</code> to <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a> (added backwards-compatible alias in v0.5.0.1).</li>
  <li>Renamed <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a>’s <code>Features</code> parameter to <code>Name</code> (added backwards-compatible alias in v0.5.0.1).</li>
  <li>Added <code>Iis</code>, <code>IisHttpRedirection</code>, <code>Msmq</code>, <code>MsmqHttpSupport</code>, and <code>HttpActiveDirectoryIntegration</code> switches to <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a>.</li>
  <li><a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>, <a href="http://get-carbon.org/help/Test-WindowsFeature.html">Test-WindowsFeature</a>, and <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a> are now available even if the current operating system doesn’t support managing Windows features.  They don’t do anything in those situations, but they exist.</li>
  <li><a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a>, <a href="http://get-carbon.org/help/Test-WindowsFeature.html">Test-WindowsFeature</a>, and <a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a> are not available if the PowerShell v3.0 server manager cmdlets exists (on Windows 8/2012).</li>
</ul>

<h3 id="miscellaneous">Miscellaneous</h3>
<ul>
  <li>Replaced all instances where functions were throwing exceptions with <code>Write-Error</code>.</li>
  <li>The Carbon assembly is now versioned and signed.</li>
</ul>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/3/">&larr; Older</a>
    
    <a href="/archive">Archive</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section style="margin-top:2em;">

	<p>
		<a href="http://twitter.com/pshdo"><img src="/storage/twitter.png" alt="" width="32" height="32" style="border:none;vertical-align:middle;" ></a>
		
		<a href="http://twitter.com/pshdo" >Follow on Twitter</a>
	</p>

</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/09/carbon-2.0-alpha.26-released.html">Carbon 2.0-alpha.26 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/09/carbon-1.8-released.html">Carbon 1.8 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/carbon-1-dot-7-released.html">Carbon 1.7 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/carbon-1-dot-6-released.html">Carbon 1.6 Released</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/carbon-v151-released.html">Carbon v1.5.1 Released</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Aaron Jensen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
