
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>> pshdo</title>
  <meta name="author" content="Aaron Jensen">

  
  <meta name="description" content="I&rsquo;ve released Carbon v0.3.1, a 100% enhancement and new feature release. New Features Created Get-ComPermissions function for getting COM &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pshdo.com/page/4/index.html">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pshdo.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/archive/atom.xml" rel="alternate" title="> pshdo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">> pshdo</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/archive/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pshdo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
	<li><a href="/about">About</a></li>
	<li><a href="/archive">Archive</a></li>
	<li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/10/29/carbon-v031-released.html">Carbon v0.3.1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-29T21:58:00-07:00" pubdate data-updated="true">Oct 29<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released Carbon v0.3.1, a 100% enhancement and new feature release.</p>

<h2 id="new-features">New Features</h2>
<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-ComPermissions.html">Get-ComPermissions</a> function for getting COM Access or Launch and Activation Permissions.  These are the permissions you see in Component Services (i.e. dcomcnfg) when you right-click <code>My Computer</code>, select <code>Properties</code>, click the <code>COM Security</code> tab then click the <code>Edit Default..</code> or <code>Edit Limits...</code> buttons under <strong>Access Permissions</strong> or <strong>Launch and Activation Permissions</strong>, respectively.</li>
  <li>Created <a href="http://get-carbon.org/help/Grant-ComPermissions.html">Grant-ComPermissions</a> for granting COM Access and/or Launch and Activation permissions.</li>
  <li>Created <a href="http://get-carbon.org/help/Revoke-ComPermissions.html">Revoke-ComPermissions</a> for revoking COM Access and/or Launch and ACtivation permissions.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> function for testing if user or group exists on the local computer or in a domain.</li>
  <li>Created <a href="http://get-carbon.org/help/Resolve-IdentityName.html">Resolve-IdentityName</a> function for determinig a user/group&rsquo;s canonical name.  For example, it converts <code>Administrators</code> into <code>BUILTIN\Administrators</code>.</li>
  <li>Created <a href="http://get-carbon.org/help/Reset-MsmqQueueManagerID.html">Reset-MsmqQueueManagerID</a> function, which resets MSMQ&rsquo;s Queue Manager ID.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>
<ul>
  <li>Improved <a href="http://get-carbon.org/help/Disable-IEEnhancedSecurityConfiguration.html">Disable-IEEnhancedSecurityConfiguration</a> and <a href="http://get-carbon.org/help/Enable-IEActivationPermissions.html">Enable-IEActivationPermissions</a> for enabling Internet Explorer to run headless by non-priveleged users.</li>
  <li>Changed the way <a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a> waits for MSI to finish installing: instead of searching for any MSI process, it now searches for an MSI process that is a child of the current PowerShell process.</li>
  <li>Simplified how <a href="http://get-carbon.org/help/Add-GroupMembers.html">Add-GroupMembers</a> adds group members.</li>
  <li>The version number in the module manifest now gets updated correctly for each release.  You should now be able to tell what version you&rsquo;re running by looking in <code>Carbon\Carbon.psd1</code>, or, if Carbon is imported in your console, running <code>Get-Module Carbon | Select-Object Version</code>.</li>
  <li>Improved the way the Windows Features functions detect the best way to manage Windows features.  The old way would write an error to the error stream, which bubbled up at weird times and made diagnosing real errors harder.</li>
  <li>Added a <code>Quiet</code> parameter to <a href="http://get-carbon.org/help/Set-RegistryKeyValue.html">Set-RegistryKeyValue</a> so that <code>Write-Host</code> output is muffled.</li>
</ul>

<p>I&rsquo;m pretty proud of the COM functions.  I&rsquo;ll try to carve out some time in the next week to describe them in more detail and why they&rsquo;re important.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/9/28/carbon-v030-released.html">Carbon v0.3.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-28T15:59:00-07:00" pubdate data-updated="true">Sep 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released version 0.3.0 of Carbon.  This release contains some minor enhancements, several bug fixes, and backwards-<strong>incompatible</strong> changes to the following functions:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Set-IisSslFlags.html">Set-IisSslFlags</a></li>
  <li><a href="http://get-carbon.org/help/Set-TrustedHosts.html">Set-TrustedHosts</a></li>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a></li>
</ul>

<h3 id="set-iissslflags">Set-IisSslFlags</h3>

<p>This function was renamed to <code>Enable-IisSsl</code>.  Its <code>Enable128BitSsl</code> parameter was renamed to <code>Require128BitSsl</code>.  </p>

<p>Configuring client certificates is now a little stricter/clearer.  You can no longer specify both <code>AcceptClientCertificates</code> and <code>RequireClientCertificates</code>.  Also, if you specify <code>RequireClientCertificates</code>, you must now also supply the <code>RequireSsl</code> switch (before, setting the <code>RequireClientCertificates</code> switch implicitly set the <code>RequireSsl</code> switch).</p>

<h3 id="set-trustedhosts">Set-TrustedHosts</h3>

<p>Make sure you&rsquo;re not calling <code>Set-TrustedHosts</code> with an empty array/value for the <code>Entries</code> parameter.  The function now throw an error in that situation.  If you need to clear the list of trusted hosts, use <code>Clear-TrustedHosts</code>.</p>

<h3 id="invoke-powershell">Invoke-PowerShell</h3>

<p>If you call <code>Invoke-PowerShell</code> without the <code>x86</code> switch and PowerShell is 32-bit, you&rsquo;ll get an error.  Under Windows x64, 32-bit PowerShell can&rsquo;t start the 64-bit instance because Windows redirects all access from C:\Windows\system32 to C:\Windows\SysWOW64.  If anyone knows how to get around this, let me know!</p>

<h2 id="enhancements">Enhancements</h2>

<ul>
  <li>Renamed <code>Set-IisSslFlags</code> to <code>Enable-IisSsl</code> to better reflect what it does.  Also, created parameter sets around client certificate settings so you can&rsquo;t configure them incorrectly.  (<a href="https://bitbucket.org/splatteredbits/carbon/issue/25/set-iissslflags-create-parameter-sets-to">Fixes #25: Set-IisSslFlags: Create parameter sets to accurately reflect what flags are allowed to be set simultaneously.</a>)</li>
  <li>Added <code>WhatIf</code> support to <a href="http://get-carbon.org/help/Install-MsmqMessageQueue.html">Install-MsmqMessageQueue</a>.</li>
  <li>Created new <a href="http://get-carbon.org/help/Clear-TrustedHosts.html">Clear-TrustedHosts</a> for clearing PowerShell&rsquo;s trusted hosts list.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<ul>
  <li>Rename <a href="http://get-carbon.org/help/Set-IisSslFlags.html">Enable-IisSsl/Set-IisSslFlags&rsquo;s</a> <code>Enable128BitSsl</code> parameter to <code>Require128BitSsl</code>] (<a href="https://bitbucket.org/splatteredbits/carbon/issue/24/set-iissslflags-rename-the-enable128bitssl">Fix #24 Set-IisSslFlags: Rename the Enable128BitSsl parameter to Require128BitSsl</a>).</li>
  <li><a href="https://bitbucket.org/splatteredbits/carbon/issue/19/install-iisapppool-doesnt-change-an">Fix issue #19</a>: <a href="http://get-carbon.org/help/Install-IisAppPool.html">Install-IisAppPool</a> doesn&rsquo;t change an existing 32-bit app pool to be a 64-bit app pool.</li>
  <li><a href="https://bitbucket.org/splatteredbits/carbon/issue/33/install-msmqmessagequeue-can-wait-forever">Fix issue #33</a>: <a href="http://get-carbon.org/help/Install-MsmqMessageQueue.html">Install-MsmqMessageQueue</a>: Can wait forever for a queue to get created.  It now waits 10 seconds.  </li>
  <li><a href="https://bitbucket.org/splatteredbits/carbon/issue/36/get-powershellpath-returns-the-wrong-path">Fix issue #36</a>: <a href="http://get-carbon.org/help/Get-PowershellPath.html">Get-PowerShellPath</a> returns the wrong path when running x86 PowerShell on x64 computers.</li>
  <li><a href="https://bitbucket.org/splatteredbits/carbon/issue/37/invoke-powershell-should-write-an-error">Fix issue #37</a>: <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> should write an error when running as x86 on Windows x64 without the x86 flag (i.e. 32-bit PowerShell can&rsquo;t launch a 64-bit PowerShell, so throw an error in that situation).</li>
  <li><a href="https://bitbucket.org/splatteredbits/carbon/issue/38/set-trustedhosts-passing-an-empty-value">Fix issue #38</a>: <a href="http://get-carbon.org/help/Set-TrustedHosts.html">Set-TrustedHosts</a>: passing an empty value for the Entries parameter clears the hosts list.  The <code>Entries</code> parameter is now required.  To clear the trusted hosts list, use <code>Clear-TrustedHosts</code>.</li>
</ul>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Go get it!</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/9/3/carbon-v027-released.html">Carbon v0.2.7 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-03T09:25:00-07:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released version 0.2.7 of Carbon this morning.  This release contains only new functionality:</p>

<h2 id="enhancements">Enhancements</h2>

<p>New functions for working with the registry:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Get-RegistryKeyValue.html">Get-RegistryKeyValue</a>: Get a value from a registry key.</li>
  <li><a href="http://get-carbon.org/help/Install-RegistryKey.html">Install-RegistryKey</a>: Create a new registry key.</li>
  <li><a href="http://get-carbon.org/help/Remove-RegistryKeyValue.html">Remove-RegistryKeyValue</a>: Remove a value from a registry key.</li>
  <li><a href="http://get-carbon.org/help/Set-RegistryKeyValue.html">Set-RegistryKeyValue</a>: Set/create a value in a registry key.</li>
  <li><a href="http://get-carbon.org/help/Test-RegistryKeyValue.html">Test-RegistryKeyValue</a>: Test if a value exists in a registry key.</li>
</ul>

<p>Other enhancements:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Unprotect-AclAccessRules.html">Unprotect-AclAccessRules</a>: Turns off inherited access rules on an item in the file system or registry.</li>
  <li>Added a <code>Clear</code> parameter to the <a href="http://get-carbon.org/help/Grant-Permissions.html">Grant-Permissions</a> function for clearing any non-inherited permissions on a file system/registry item.</li>
</ul>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Go get it!</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/7/7/setup-automation-with-powershell-slides.html">Setup Automation With PowerShell Slides</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-07T16:23:00-07:00" pubdate data-updated="true">Jul 7<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For the twelve of you who attended, <a href="/storage/slides/SetupAutomationWithPowerShell.pdf">here are my slides</a> from my <a href="http://opensourcebridge.org/sessions/829">Setup Automation with PowerShell session</a> at Open Source Bridge 2012.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/30/carbon-v026-released.html">Carbon v0.2.6 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-30T12:49:00-07:00" pubdate data-updated="true">Jun 30<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve releaed <a href="http://get-carbon.org">Carbon</a> v0.2.6.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download it from BitBucket.</a>  </p>

<p>With this release, I&rsquo;ve completed all documentation for Carbon&rsquo;s 100+ functions.  Sample scripts and the HTML help files are also now included in the download package.  There&rsquo;s also one bug fix.  Here are the complete release notes:</p>

<h2 id="enhancements">Enhancements</h2>
<p>Improved documentation for:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Grant-ServiceControlPermission.html">Grant-ServiceControlPermission</a></li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a></li>
  <li><a href="http://get-carbon.org/help/Invoke-SubInAcl.html">Invoke-SubInAcl</a></li>
  <li><a href="http://get-carbon.org/help/Remove-Service.html">Remove-Service</a></li>
  <li><a href="http://get-carbon.org/help/Restart-RemoteService.html">Restart-RemoteService</a></li>
  <li><a href="http://get-carbon.org/help/Install-Share.html">Install-Share</a></li>
  <li><a href="http://get-carbon.org/help/Add-GroupMembers.html">Add-GroupMembers</a></li>
  <li><a href="http://get-carbon.org/help/Get-WmiLocalUserAccount.html">Get-WmiLocalUserAccount</a></li>
  <li><a href="http://get-carbon.org/help/Install-Group.html">Install-Group</a></li>
  <li><a href="http://get-carbon.org/help/Install-User.html">Install-User</a></li>
  <li><a href="http://get-carbon.org/help/Remove-User.html">Remove-User</a></li>
  <li><a href="http://get-carbon.org/help/Test-User.html">Test-User</a></li>
  <li><a href="http://get-carbon.org/help/Install-WindowsFeatureIis.html">Install-WindowsFeatureIis</a></li>
  <li><a href="http://get-carbon.org/help/Install-WindowsFeatureMsmq.html">Install-WindowsFeatureMsmq</a></li>
  <li><a href="http://get-carbon.org/help/Install-WindowsFeatures.html">Install-WindowsFeatures</a></li>
  <li><a href="http://get-carbon.org/help/Test-WindowsFeature.html">Test-WindowsFeature</a></li>
  <li><a href="http://get-carbon.org/help/Uninstall-WindowsFeatures.html">Uninstall-WindowsFeatures</a></li>
  <li><a href="http://get-carbon.org/help/Assert-FirewallConfigurable.html">Assert-FirewallConfigurable</a></li>
  <li><a href="http://get-carbon.org/help/Disable-FirewallStatefulFtp.html">Disable-FirewallStatefulFtp</a></li>
  <li><a href="http://get-carbon.org/help/Enable-FirewallStatefulFtp.html">Enable-FirewallStatefulFtp</a></li>
  <li><a href="http://get-carbon.org/help/Get-FirewallRules.html">Get-FirewallRules</a></li>
  <li><a href="http://get-carbon.org/help/Test-FirewallStatefulFtp.html">Test-FirewallStatefulFtp</a></li>
  <li><a href="http://get-carbon.org/help/Find-ADUser.html">Find-ADUser</a></li>
  <li><a href="http://get-carbon.org/help/Format-ADSpecialCharacters.html">Format-ADSpecialCharacters</a></li>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a></li>
  <li><a href="http://get-carbon.org/help/Get-CertificateStore.html">Get-CertificateStore</a></li>
  <li><a href="http://get-carbon.org/help/Set-HgrcDefaultPushUrl.html">Set-HgrcDefaultPushUrl</a></li>
</ul>

<p>Additional enhancements:</p>

<ul>
  <li>Help files and example scripts now included in Carbon download package.</li>
  <li>Added test to help ensure all functions have proper documentation.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<ul>
  <li><a href="http://get-carbon.org/help/Install-IisWebsite.html">Install-IisWebsite</a> now validates the website bindings.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/28/carbon-v025-released.html">Carbon v0.2.5 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-29T10:26:00-07:00" pubdate data-updated="true">Jun 29<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released <a href="http://get-carbon.org">Carbon</a> v0.2.5.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download it from BitBucket.</a> It&rsquo;s 100% <a href="http://get-carbon.org">documentation updates</a>.  I&rsquo;ve now completed documentation on 80% of Carbon&rsquo;s functions.  Hopefully I&rsquo;ll be able to finish the final 20% today.</p>

<h2 id="enhancements">Enhancements</h2>
<p>Improved documentation for:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Test-IisAppPool.html">Test-IisAppPool</a></li>
  <li><a href="http://get-carbon.org/help/Test-IisWebsiteExists.html">Test-IisWebsiteExists</a></li>
  <li><a href="http://get-carbon.org/help/Unlock-IisBasicAuthentication.html">Unlock-IisBasicAuthentication</a></li>
  <li><a href="http://get-carbon.org/help/Unlock-IisCgi.html">Unlock-IisCgi</a></li>
  <li><a href="http://get-carbon.org/help/Unlock-IisConfigSection.html">Unlock-IisConfigSection</a></li>
  <li>Import-Carbon.ps1</li>
  <li><a href="http://get-carbon.org/help/Set-IniEntry.html">Set-IniEntry</a></li>
  <li><a href="http://get-carbon.org/help/Split-Ini.html">Split-Ini</a></li>
  <li><a href="http://get-carbon.org/help/Set-HgrcDefaultPushUrl.html">Set-HgrcDefaultPushUrl</a></li>
  <li><a href="http://get-carbon.org/help/Get-MsmqMessageQueue.html">Get-MsmqMessageQueue</a></li>
  <li><a href="http://get-carbon.org/help/Get-MsmqMessageQueuePath.html">Get-MsmqMessageQueuePath</a></li>
  <li><a href="http://get-carbon.org/help/Grant-MsmqMessageQueuePermissions.html">Grant-MsmqMessageQueuePermissions</a></li>
  <li><a href="http://get-carbon.org/help/Install-Msmq.html">Install-Msmq</a></li>
  <li><a href="http://get-carbon.org/help/Install-MsmqMessageQueue.html">Install-MsmqMessageQueue</a></li>
  <li><a href="http://get-carbon.org/help/Remove-MsmqMessageQueue.html">Remove-MsmqMessageQueue</a></li>
  <li><a href="http://get-carbon.org/help/Test-MsmqMessageQueue.html">Test-MsmqMessageQueue</a></li>
  <li><a href="http://get-carbon.org/help/Get-PerformanceCounters.html">Get-PerformanceCounters</a></li>
  <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a></li>
  <li><a href="http://get-carbon.org/help/Test-PerformanceCounter.html">Test-PerformanceCounter</a></li>
  <li><a href="http://get-carbon.org/help/Test-PerformanceCounterCategory.html">Test-PerformanceCounterCategory</a></li>
  <li><a href="http://get-carbon.org/help/Uninstall-PerformanceCounterCategory.html">Uninstall-PerformanceCounterCategory</a></li>
  <li><a href="http://get-carbon.org/help/Complete-Jobs.html">Complete-Jobs</a></li>
  <li><a href="http://get-carbon.org/help/Get-PowershellPath.html">Get-PowershellPath</a></li>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a></li>
  <li><a href="http://get-carbon.org/help/Test-PowerShellIs32Bit.html">Test-PowerShellIs32Bit</a></li>
  <li><a href="http://get-carbon.org/help/Test-PowerShellIs64Bit.html">Test-PowerShellIs64Bit</a></li>
  <li><a href="http://get-carbon.org/help/Add-TrustedHosts.html">Add-TrustedHosts</a></li>
  <li><a href="http://get-carbon.org/help/Get-TrustedHosts.html">Get-TrustedHosts</a></li>
  <li><a href="http://get-carbon.org/help/Set-TrustedHosts.html">Set-TrustedHosts</a></li>
  <li><a href="http://get-carbon.org/help/Assert-AdminPrivileges.html">Assert-AdminPrivileges</a></li>
  <li><a href="http://get-carbon.org/help/Convert-SecureStringToString.html">Convert-SecureStringToString</a></li>
  <li><a href="http://get-carbon.org/help/Grant-Permissions.html">Grant-Permissions</a></li>
  <li><a href="http://get-carbon.org/help/New-Credential.html">New-Credential</a></li>
  <li><a href="http://get-carbon.org/help/Test-AdminPrivileges.html">Test-AdminPrivileges</a></li>
  <li>Improved whitespace in HTML documentation code samples.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/28/carbon-v024-released.html">Carbon v0.2.4 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-28T12:07:00-07:00" pubdate data-updated="true">Jun 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released <a href="http://get-carbon.org">Carbon</a> v0.2.4.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download it from BitBucket.</a>  This release is 100% <a href="http://get-carbon.org/help">documentation</a> improvements.  (Anyone out there notice a this week&rsquo;s theme?)</p>

<h2 id="enhancements">Enhancements</h2>
<p>Improved documentation for:</p>

<ul>
  <li>Get-PathCanonicalCase</li>
  <li>Get-PathRelativeTo</li>
  <li>New-Junction</li>
  <li>New-TempDir</li>
  <li>Remove-Junction</li>
  <li>Test-PathIsJunction</li>
  <li>Reset-HostsFile</li>
  <li>Set-HostsEntry</li>
  <li>Add-IisDefaultDocument</li>
  <li>Get-IisHttpRedirect</li>
  <li>Get-IisVersion</li>
  <li>Get-IisWebsite</li>
  <li>Install-IisApplication</li>
  <li>Install-IisAppPool</li>
  <li>Install-IisVirtualDirectory</li>
  <li>Install-IisWebsite</li>
  <li>Invoke-AppCmd</li>
  <li>Remove-IisWebsite</li>
  <li>Set-IisAnonymousAuthentication</li>
  <li>Set-IisBasicAuthentication</li>
  <li>Set-IisDirectoryBrowsing</li>
  <li>Set-IisHttpRedirect</li>
  <li>Set-IisSslFlags</li>
  <li>Set-IisWebsiteSslCertifiate</li>
  <li>Set-IisWindowsAuthentication</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/27/carbon-v023-released.html">Carbon v0.2.3 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-27T09:56:00-07:00" pubdate data-updated="true">Jun 27<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released Carbon v0.2.3. <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download it from BitBucket.</a>  It&rsquo;s mostly documentation updates, but I snuck a couple of bug fixes in there.</p>

<h2 id="enhancements">Enhancements</h2>

<p>Improved documentation for:</p>

<ul>
  <li><a href="http://get-carbon.org/help/Disable-IEEnhancedSecurityConfiguration.html">Disable-IEEnhancedSecurityConfiguration</a></li>
  <li><a href="http://get-carbon.org/help/Enable-IEActivationPermissions.html">Enable-IEActivationPermissions</a></li>
  <li><a href="http://get-carbon.org/help/Disable-IEEnhancedSecurityConfiguration.html">Get-FullPath</a></li>
  <li><a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a></li>
  <li><a href="http://get-carbon.org/help/Protect-String.html">Protect-String</a></li>
  <li><a href="http://get-carbon.org/help/Remove-EnvironmentVariable.html">Remove-EnvironmentVariable</a></li>
  <li><a href="http://get-carbon.org/help/Set-DotNetAppSetting.html">Set-DotNetAppSetting</a></li>
  <li><a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString</a></li>
  <li><a href="http://get-carbon.org/help/Set-EnvironmentVariable.html">Set-EnvironmentVariable</a></li>
  <li><a href="http://get-carbon.org/help/Test-OSIs32Bit.html">Test-OSIs32Bit</a></li>
  <li><a href="http://get-carbon.org/help/Test-OSIs64Bit.html">Test-OSIs64Bit</a></li>
  <li><a href="http://get-carbon.org/help/Unprotect-String.html">Unprotect-String</a></li>
</ul>

<h2 id="bug-fixes">Bug fixes</h2>
<ul>
  <li><a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a> doesn&rsquo;t validate that installer path ends in &lsquo;.msi&rsquo;.</li>
  <li><a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a> not showing correct exit code when installation fails.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/19/carbon-v022-released.html">Carbon v0.2.2 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-19T17:28:00-07:00" pubdate data-updated="true">Jun 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve released Carbon v0.2.2.  <a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download it from BitBucket.</a>  There were a bunch of documentation improvements, along with the following:</p>

<h2 id="enhancements">Enhancements</h2>

<ul>
  <li>Created Import-Carbon script to help users properly import Carbon.</li>
</ul>

<h2 id="bug-fixes">Bug fixes</h2>

<ul>
  <li>Add-GroupMembers fails to add Administrators and ANONYMOUS LOGON built-in accounts.</li>
  <li>Add-GroupMembers fails when adding built-in accounts multiple times.</li>
  <li>Add-GroupMembers fails to add domain user to a local group.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archive/2012/6/4/best-practices-for-importing-powershell-modules.html">Best Practices for Importing PowerShell Modules</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-04T14:59:00-07:00" pubdate data-updated="true">Jun 4<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="importing-modules-is-messy">Importing Modules Is Messy</h2>

<p>An error users encounter with <a href="http://get-carbon.org">Carbon</a> is double-importing its extended type data file.  If Carbon has been imported in another module (i.e. Carbon is a sub-module of that module), when you use <code>Import-Module</code> to import Carbon, PowerShell will sometimes complain about not being able to load Carbon&rsquo;s extended data file:</p>

<pre><code>&gt; Import-Module SubModuleWhichImportsCarbon
&gt; Import-Module Carbon
Import-Module : The following error occurred while loading the extended type data file:
Microsoft.PowerShell, Carbon.types.ps1xml : File skipped because it was already present from "Microsoft.PowerShell".
</code></pre>

<p>I&rsquo;ve tried a bunch of things to mitigate this error.  I&rsquo;ve always just wanted to import Carbon with one line of code:</p>

<pre><code>Import-Module Carbon
</code></pre>

<p>At first, I tried using the <code>-Force</code> parameter to <code>Import-Module</code>, but that didn&rsquo;t work.  Then I tried removing Carbon if it was present before importing it again:</p>

<pre><code>if( (Get-Module Carbon) )
{
	Remove-Module Carbon
}
Import-Module Carbon
</code></pre>

<p>Unfortunately, the above code doesn&rsquo;t work when Carbon is a sub-module because <code>Get-Module</code> doesn&rsquo;t return sub-modules.  </p>

<p>Next, I updated all my modules that imported Carbon to check for and remove any stand-alone Carbon modules before importing Carbon.  I basically added the code above to all the modules that used Carbon.  This approach worked most of the time, but there were still weird edge cases that caused the double-import error.  The only solution left, I thought, was to re-write all my scripts to add additional code to detect a Carbon sub-module.  That&rsquo;s a lot of scripts to update and a lot of duplicate code between scripts.</p>

<h2 id="the-solution">The Solution</h2>

<p>Looking back, I can see that my brain was stuck in the rut of trying to solve the problem in each of my scripts using as few lines as possible.  It hit me the other day that I should write an <code>Import-Carbon.ps1</code> script which properly handles all the weird edge cases. With this script in place, I could update all my scripts that use Carbon to call <code>Import-Carbon.ps1</code> to do the import.</p>

<pre><code>$PSScriptRoot = Split-Path -Parent $MyInvocation.MyCommand.Definition
&amp; (Join-Path $PSScriptRoot Tools\Carbon\Import-Carbon.ps1 -Resolve)
</code></pre>

<p>Finally!  One line of code to import a module.  And, only one place to change if additional weird edge cases pop up.</p>

<h2 id="sub-module-detection">Sub-module Detection</h2>

<p>Now, I just had to write code to detect a Carbon sub-module.  The best way to do this is to check for the presence of a variable or function specific to a module.  In this case, I use the <code>$CarbonImported</code> variable, which I added to Carbon for just this purpose:</p>

<pre><code>if( (Get-Module Carbon) )
{
    Remove-Module Carbon
}
elseif( Test-Path "variable:CarbonImported" )
{
    $var = Get-Variable 'CarbonImported'
    $varModule = Get-Module $var.Module
    Write-Warning ("Carbon already present as nested module in {0} module ({1})." -f $var.Module, $varModule.ModuleBase)    
    return
}

Import-Module Carbon
</code></pre>

<p>If Carbon is present as a sub-module, I write out a warning and return without attempting a re-import.  </p>

<h2 id="therefore-what">Therefore, What?</h2>

<p>When writing a module, <strong>always write and include a script that safely imports the module</strong>.  I recommend using the above code as a template.  If you&rsquo;re using a module that doesn&rsquo;t include a safe import scrpt, write one yourself.  Test for a variable or function that is specific to the module.  (That&rsquo;s not fool-proof, however.  Users can always import individual functions and variables from your module.  In that case, the function/variable you&rsquo;re detecting may not have been imported, and the detection will fail.)  </p>

<p><strong>Don&rsquo;t</strong> detect the presence of your assemblies or types.  They remain loaded even if your module has been removed.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/5/">&larr; Older</a>
    
    <a href="/archive">Archive</a>
    
    <a class="next" href="/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section style="margin-top:2em;">

	<p>
		<a href="http://twitter.com/pshdo"><img src="/storage/twitter.png" alt="" width="32" height="32" style="border:none;vertical-align:middle;" ></a>
		
		<a href="http://twitter.com/pshdo" >Follow on Twitter</a>
	</p>

</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2016/09/carbon-2.3.0-released.html">Carbon 2.3.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2016/05/carbon-2.2.0-released.html">Carbon 2.2.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2016/02/carbon-2.1.1-released.html">Carbon 2.1.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/2016/02/carbon-2.1.0-released.html">Carbon 2.1.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/carbon-2.0.1-released.html">Carbon 2.0.1 Released</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Aaron Jensen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
