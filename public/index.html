
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>> pshdo</title>
  <meta name="author" content="Aaron Jensen">

  
  <meta name="description" content="Carbon 2.0.0 is out. You can download Carbon as a .ZIP archive, NuGet package, Chocolatey package, or from the PowerShell Gallery. It may take a week &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pshdo.com/index.html">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pshdo.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/archive/atom.xml" rel="alternate" title="> pshdo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">> pshdo</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/archive/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pshdo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
	<li><a href="/about">About</a></li>
	<li><a href="/archive">Archive</a></li>
	<li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2015/10/carbon-2.0.0-released.html">Carbon 2.0.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-10T20:29:00-07:00" pubdate data-updated="true">Oct 10<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> 2.0.0 is out. You can <a href="http://get-carbon.org/about_Carbon_Installation.html">download Carbon as a .ZIP archive, NuGet package, Chocolatey package, or from the PowerShell Gallery</a>. It may take a week or two for the package to show up at chocolatey.org.</p>

<h2 id="overview">Overview</h2>

<p>Carbon version 2.0 is a <em>huge</em> release, with lots of new enhancements and bug fixes. We hope you like them. Carbon 2.0 now requires PowerShell 4, so it is not backwards-compatabile with Carbon 1.x. Because of this, we made some additional backwards-incompatible changes. See the <code>Upgrade Instructions</code> section for things to look out for.</p>

<p>If you’re upgrading from a previous 2.0 alpha release, you’ll want to review the changes since your alpha version (found after the <em>Upgrade Instructions</em> section). We improved backwards-compatability with Carbon 1.x since the last alpha release, but that broke compatability with the alphas. </p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<p>Make sure you’re running PowerShell 4. </p>

<p><code>Install-Certificate</code>’s parameters have changed:</p>

<ul>
  <li>Remove the <code>Exportable</code> switch from any usages of <code>Install-Certificate</code> when installing from an <code>X509Certificate2</code> <em>object</em>, since that switch only gets used when installing a certificate from a file.</li>
</ul>

<p>Some functions now return different objects and/or the objects returned have changed:</p>

<ul>
  <li>Use the <code>Sid</code> property on objects returned by <code>Test-Identity</code> when using the <code>PassThru</code> switch: it now returns a <code>Carbon.Identity</code> object if the identity exists <em>and</em> you use the <code>-PassThru</code> switch, e.g. <code>Test-Identity -Name $userName -PassThru | Select-Object -Expand 'Sid'</code>.</li>
  <li>Update usages of <code>Carbon.Computer.ProgramInstallInfo</code>’s <code>Version</code> property (returned by <code>Get-ProgramInstallInfo</code>). It was an <code>int</code> and is now a <a href="http://msdn.microsoft.com/en-us/library/y0hf9t2e.aspx">Version</a> object.</li>
</ul>

<p>The Carbon assembly was re-organized. If you were reaching into <code>Carbon.dll</code> (<strong><em>NOT RECOMMENDED</em></strong>), you’ll want to:</p>

<ul>
  <li>Rename usages of <code>[Carbon.AdvApi32]</code> class to <code>[Carbon.Service.ServiceSecurity]</code>.</li>
  <li>Rename usages of <code>[Carbon.Lsa]</code> class to <code>[Carbon.Security.Privilege]</code>.</li>
  <li>Rename usages of <code>[Carbon.Win32]</code> class to <code>[Carbon.FileSystem.Path]</code>.</li>
  <li>Rename usages of <code>[Carbon.HandleInfo]</code> class to <code>[Carbon.Win32.HandleInfo]</code>.</li>
  <li>Remove usages of <code>[Carbon.Lsa]::LookupPrivilegeValue</code> class method. It was incorrectly exposed as a public method.</li>
  <li>Remove usages of <code>[Carbon.Kernel32]::LocalFree</code> class method. It was incorrectly exposed as a public method.</li>
</ul>

<p>The following commands no longer return the stdout output from the console applications each one calls. To see the old output, use the <code>-Verbose</code> switch. Remove any usage of the output you were processing.</p>

<ul>
  <li>All IIS functions.</li>
  <li><code>Disable-FirewallStatefulFtp</code></li>
  <li><code>Enable-FirewallStatefulFtp</code></li>
  <li><code>Install-Service</code></li>
  <li><code>Install-SmbShare</code></li>
  <li><code>Remove-SslCertificateBinding</code></li>
  <li><code>Set-SslCertificateBinding</code></li>
  <li><code>Uninstall-Service</code></li>
</ul>

<p>The following functions’ internal behavior has changed. This may or may not impact you.</p>

<ul>
  <li><code>Grant-Permission</code> now only grants permissions on an object if those permissions aren’t present.  To preserve previous behavior, add the <code>-Force</code> switch to all <code>Grant-Permission</code> usages.</li>
  <li><code>Grant-Permission</code> now writes an error if you don’t have access to a private key. Previously, it would skip the key without any messages.</li>
  <li><code>Install-Msi</code> (fka <code>Invoke-WindowsInstaller</code>) now only installs the MSI if it isn’t already installed. To preserve the previous behavior and always install, add the <code>-Force</code> switch to all <code>Invoke-WindowsInstaller</code>`Install-Msi` usages.</li>
  <li>All IIS functions were re-written to use the <code>Microsoft.Web.Administration</code> API instead of <code>appcmd.exe</code>.</li>
  <li><code>Install-IisWebsite</code> no longer deletes and re-creates websites. If a website exists, it updates its configuration to match parameters passed in. To preserve previous behavior and delete the website before installing, use the <code>-Force</code> switch.</li>
  <li><code>Install-IisVirtualDirectory</code> no longer deletes and re-creates virtual directories. If a virtual directory exists, its configuration is updated in place. To preserve previous behavior and delete the virtual directory before installing, use the <code>Force</code> switch.</li>
  <li><code>Install-FileShare</code> (fka <code>Install-SmbShare</code>) no longer deletes and re-creates the share, instead it modifies existing shares in place. To preserve previous behavior and delete existing shares before re-creating, use the <code>Force</code> switch.</li>
  <li><code>Set-RegistryKeyValue</code> only sets the value if the value doesn’t exist or the current value is different than the desired value.</li>
</ul>

<p>We’ve added parameter validation to some functions. This shouldn’t impact anybody, since if you were passing data that breaks this new validation, the function wouldn’t have worked even in previous versions of Carbon.</p>

<ul>
  <li>Ensure that all thumbprints passed to <code>Set-SslCertificateBinding</code> are valid (40 character hex strings), since it now validates thumbprints.</li>
  <li>Check that all IP addresses passed to <code>Set-HostsEntry</code> are valid IP v4 or v6 addresses.  <code>Set-HostsEntry</code>’s IPAddress parameter is now a <code>System.Net.IPAddress</code> object.  Previously it was a string validated with a regular expression, so you <em>should</em> be OK.</li>
</ul>

<p>All Carbon functions now respect each caller’s common parameters (e.g. <code>-Verbose</code>, <code>-ErrorAction</code>, etc.). This means if you pass a common parameter to a script that calls a Carbon function, that Carbon function will use that common parameter. This may or may not impact you.</p>

<h2 id="bug-fixes">Bug Fixes</h2>

<ul>
  <li>Carbon’s <code>System.ServiceProcess.ServiceController</code> extended type data causes errors when PowerShell formats <code>System.ServiceProcess.ServiceController</code> objects that represent services on remote computers.</li>
  <li><code>Compress-Item</code> doesn’t remove handled errors from global error array.</li>
  <li><code>Grant-Permission</code> fails with an unhelpful error message if it is unable to get the ACL on a private key.</li>
  <li><code>Install-Msi</code> didn’t properly detect when installation failed.</li>
  <li><code>Install-ScheduledTask</code> fails under PowerShell 5 to create a scheduled task to run on Sunday.</li>
  <li><code>Install-Service</code>:
    <ul>
      <li>No longer writes a warning about being unable to stop an already stopped service (fixes <a href="https://bitbucket.org/splatteredbits/carbon/issues/158/install-service-extraneous-warning-about">issue #158</a>).</li>
      <li>Starting the service now respects caller’s error action preference. Before, <code>Start-Service</code> would write an error even if somone called <code>Install-Service</code> with an <code>Ignore</code> or <code>SilentlyContinue</code> error action preference.</li>
      <li>Service arguments that are quoted still get quoted. Now, quotes are trimmed before arguments are quoted.</li>
    </ul>
  </li>
  <li><code>Set-EnvironmentVariable</code> fails to set process-level environment variable. </li>
  <li><code>Set-HostsEntry</code> fails to preserve whitespace if existing lines end with a comment/description. Thanks to <a href="https://vk.com/kostanew">Konstantin Ushenin</a> for the fix.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>Carbon now requires PowerShell 4.</li>
  <li><code>Import-Carbon.ps1</code> is more intelligent about when it tries to re-load Carbon. It will force a re-import of Carbon if any of Carbon’s files have changed or the version has changed.</li>
  <li>Added new <code>FileIndex</code>, <code>LinkCount</code>, and <code>VolumeSerialNumber</code> extended type data on <code>System.IO.FileInfo</code> objects for getting a file’s index, its hard link count, and volume serial number, respectively.</li>
  <li>The product version of the Carbon assembly now includes pre-release version information, as defined by the <a href="http://semver.org">Semantic Versioning specification</a>. To get this version, run <code>Get-Item Carbon.dll | Select-Object -ExpandProperty 'VersionInfo' | Select-Object -ExpandProperty 'ProductVersion'</code>.</li>
  <li>The Carbon NuGet package now supports installing and uninstalling under Chocolatey.</li>
  <li>All IIS functions were re-written to use the <code>Microsoft.Web.Administration</code> API instead of <code>appcmd.exe</code>. As a side effect, they no longer return <code>appcmd.exe</code> console output.</li>
  <li>The following functions no longer use <code>Write-Host</code>. Instead, they use <code>Write-Verbose</code>:
    <ul>
      <li><code>Disable-NtfsCompression</code></li>
      <li><code>Enable-NtfsCompression</code></li>
      <li><code>Grant-ComPermission</code></li>
      <li><code>Grant-Permission</code></li>
      <li><code>Install-Service</code> </li>
      <li><code>Remove-SslCertificateBinding</code> </li>
      <li><code>Revoke-ComPermission</code> </li>
    </ul>
  </li>
  <li>Created default, table-based display formats for <code>System.DirectoryServices.AccountManagement.UserPrincipal</code>, <code>System.DirectoryServices.AccountManagement.GroupPrincipal</code>, <code>Microsoft.Web.Administration.ApplicationPool</code>, <code>Microsoft.Web.Administration.Site</code>, and <code>Microsoft.Web.Administration.Application</code> objects.</li>
  <li>Re-organized Carbon’s internal directory structure. You shouldn’t be reaching into Carbon’s internals, so this shouldn’t matter, but wanted to let everyone know just in case.</li>
</ul>

<h3 id="new-functions">New Functions</h3>

<ul>
  <li><code>Clear-DscLocalResourceCache</code> clears the local LCM’s DSC resource. This makes developing resources easier.</li>
  <li><code>Clear-MofAuthoringMetadata</code> removes authoring metadata from .mof files.</li>
  <li><code>Copy-DscResource</code> copies DSC resources (ZIP files, MSI archives, MOF files, etc.), including timestamps, checksums, and copying only changed files.</li>
  <li><code>ConvertTo-SecurityIdentifer</code> converts a binary, string, or <code>System.Security.Principal.SecurityIdentifier</code> object into a <code>System.Security.Principal.SecurityIdentifier</code> object.</li>
  <li><code>Get-DscError</code> gets any DSC errors that were written to a computer’s DSC event log.</li>
  <li><code>Get-DscWinEvent</code> gets DSC events that were written to a computer’s DSC event log.</li>
  <li><code>Get-FileSharePermission</code> gets the sharing permissions on a file/SMB share (<em>not</em> the NTFS file system permissions).</li>
  <li><code>Get-FileShare</code> uses WMI to get <code>Win32_Share</code> objects for the file shares installed on the local computer.</li>
  <li><code>Get-Group</code> gets a local group or all local groups.</li>
  <li><code>Get-Msi</code> reads installer information and properties from an MSI file.</li>
  <li><code>Get-PowerShellModuleInstallPath</code> gets the path where new module’s should be installed. Beginning with PowerShell 4, modules should get installed into <code>$env:ProgramFiles\Windows PowerShell\Modules</code>. Under PowerShell 3, it is <code>$PSHome\Modules</code>. This function returns the correct location for the version of PowerShell you’re using.</li>
  <li><code>Get-User</code> gets a local user or all local users.</li>
  <li><code>Initialize-Lcm</code> configures the DSC Local Configuration Manager on computers, including installing the private key needed for decrypting credentials.</li>
  <li><code>Remove-GroupMember</code> removes a user/group from a local group. Thanks to <a href="https://bitbucket.org/philkloose">Philip Kluss</a> for the contribution. </li>
  <li><code>Resolve-Identity</code> converts a system, local, or domain principal name or a SID (as a <code>SecurityIdentifer</code>, string SDDL, or byte array) into its canonical representation and includes extended identity information: domain, type, and SID.</li>
  <li><code>Start-DscPullConfiguration</code> starts a configuration check on a computer that is configured to use the PULL refresh mode.</li>
  <li><code>Test-DscTargetResource</code> compares target resource with desired resource. Helpful when writing <code>Test-TargetResource</code> functions.</li>
  <li><code>Test-Group</code> checks if a <em>local</em> group exists.</li>
  <li><code>Test-FileShare</code> uses WMI to check if a file/SMB share exists on the local computer.</li>
  <li><code>Test-TypeDataMember</code> tests if a type has an extended type member defined.</li>
  <li><code>Uninstall-FileShare</code> uninstalls/removes a file share, if it exists.</li>
  <li><code>Write-DscError</code> writes DSC <code>ErrorLogRecord</code> objects as errors.</li>
</ul>

<h3 id="new-dsc-resources">New DSC Resources</h3>

<ul>
  <li><code>Carbon_EnvironmentVariable</code> creates/removes machine-level environment variables.</li>
  <li><code>Carbon_FirewallRule</code> configures firewall rules.</li>
  <li><code>Carbon_IniFile</code> manages the contents of INI files.</li>
  <li><code>Carbon_Permission</code> configures file, directory, registry, and certificate permissions.</li>
  <li><code>Carbon_Privilege</code> configures an identity’s privileges.</li>
  <li><code>Carbon_ScheduledTask</code> configures scheduled tasks with <code>schtasks.exe</code>.</li>
  <li><code>Carbon_Service</code> configures Windows services.</li>
</ul>

<h3 id="added-passthru-switches">Added <code>PassThru</code> Switches</h3>

<p>Added a <code>PassThru</code> switch to the following functions, which will return objects of the given type:</p>

<ul>
  <li><code>Grant-ComPermission</code>: <code>Carbon.Security.ComAccessRule</code>, representing the granted permission.</li>
  <li><code>Grant-Permission</code>: <code>System.Security.AccessControl.AccessRule</code>, representing the granted permission.</li>
  <li><code>Install-Group</code>: <code>System.DirectoryServices.AccountManagement.GroupPrincipal</code>, representing the group. </li>
  <li><code>Install-IisApplication</code>: <code>Microsoft.Web.Administration.Application</code>, representing the application.</li>
  <li><code>Install-IisWebsite</code>: <code>Microsoft.Web.Administration.Site</code>, representing the website.</li>
  <li><code>Install-Junction</code>: <code>System.IO.DirectoryInfo</code>, representing new target directories and any new/updated junctions.</li>
  <li><code>Install-Service</code>: <code>System.ServiceProcess.ServiceController</code>, representing the service.</li>
  <li><code>Install-User</code>: <code>System.DirectoryServices.AccountManagement.UserPrincipal</code>, representing the user.</li>
  <li><code>Set-SslCertificateBinding</code>: <code>Carbon.Certificates.SslCertificateBinding</code>, representing the configured binding.</li>
</ul>

<h3 id="no-more-console-output">No More Console Output</h3>

<p>The following functions no longer return the console output of the program each one runs. Instead, the output is written to the verbose stream (i.e. use the <code>-Verbose</code> switch to see it).</p>

<ul>
  <li><code>Disable-FirewallStatefulFtp</code></li>
  <li><code>Enable-FirewallStatefulFtp</code></li>
  <li><code>Install-Service</code></li>
  <li><code>Remove-SslCertificateBinding</code></li>
  <li><code>Set-SslCertificateBinding</code></li>
  <li><code>Uninstall-Service</code></li>
</ul>

<h3 id="obsolete-functions-and-parameters">Obsolete Functions and Parameters</h3>

<p>The following functions are now obsolete. Please don’t use them and stop using them if you are. They will be removed from a future major version of Carbon. You’ll get warnings if you use them.</p>

<ul>
  <li><code>Complete-Job</code>: It’s total crap. Use PowerShell’s <code>Wait-Job</code> cmdlet instead.</li>
  <li><code>Invoke-AppCmd</code>: Switch to Carbon’s IIS functions, or use <code>Get-IisConfigurationSection</code> to get <code>ConfigurationElement</code> objects from the <code>Microsoft.Web.Administration</code> API that you can modify.</li>
  <li><code>Resolve-NetPath</code>: Switch to something else. Carbon doesn’t use <code>net.exe</code> anymore.</li>
</ul>

<p>The following functions now have obsolete parameters, which will be removed from a future major version of Carbon. You’ll get warnings if you use them.</p>

<ul>
  <li><code>Install-IisAppPool's</code> <code>UserName</code> and <code>Password</code> parameters. Use the new <code>Credential</code> parameter instead.</li>
  <li><code>Install-Msi's</code> <code>Quiet</code> switch. <code>Install-Msi</code> always installs in quiet mode. Please remove usages.</li>
  <li><code>Install-Service's</code> <code>Password</code> parameter. Use the new <code>Credential</code> parameter instead.</li>
  <li><code>Install-User's</code> <code>UserName</code> and <code>Password</code> parameters. Use the new <code>Credential</code> parameter instead.</li>
  <li><code>Set-RegistryKeyValue</code>’s <code>Quiet</code> parameter. Please remove usages.</li>
</ul>

<h3 id="renamed-functions">Renamed Functions</h3>

<p>The following functions were renamed, but with backwards-compatible aliases in place, so you shouldn’t have to change any code.</p>

<ul>
  <li><code>Invoke-WindowsInstaller</code> -&gt; <code>Install-Msi</code></li>
  <li><code>Install-SmbShare</code> -&gt; <code>Install-FileShare</code></li>
</ul>

<h3 id="switch-to-systemdirectoryservicesaccountmanagement-api-for-usergroup-management">Switch to System.DirectoryServices.AccountManagement API for User/Group Management</h3>

<p>The following functions were re-written to use the <code>System.DirectoryServices.AccountManagement</code> API, introduced in .NET 3.5.</p>

<ul>
  <li><code>Add-MemberToGroup</code></li>
  <li><code>Install-Group</code></li>
  <li><code>Install-User</code> </li>
  <li><code>Test-User</code></li>
  <li><code>Uninstall-User</code></li>
</ul>

<h3 id="miscellaneous-changes">Miscellaneous Changes</h3>

<ul>
  <li><code>Get-IisAppPool</code>
    <ul>
      <li>Now return all application pools installed on the local computer when called with no parameters.</li>
      <li>Added a default table format for <code>Microsoft.Web.Administration.ApplicationPool</code> objects.</li>
    </ul>
  </li>
  <li><code>Get-ProgramInstallInfo</code>
    <ul>
      <li>Return object’s <code>Version</code> property changed from an <code>int</code> to a <a href="http://msdn.microsoft.com/en-us/library/y0hf9t2e.aspx">Version</a> object.</li>
      <li>Return object’s now have <code>ProductCode</code> and <code>User</code> properties. If a program doesn’t have a product code, it is set to <code>[Guid]::Empty</code>. The <code>User</code> property is only set for per-user software installs.</li>
    </ul>
  </li>
  <li><code>Get-ServiceConfiguration</code> now supports services from remote computers.</li>
  <li><code>Grant-Permission</code> now only grants permissions on an object if those permissions aren’t present.  To preserve previous behavior, add the <code>-Force</code> switch to all <code>Grant-Permission</code> usages.</li>
  <li><code>Install-Certificate's</code> <code>Exportable</code> switch is now only allowed when installing a certificate from a file. Previously, you could supply the switch when installing from an X509Certificate2 object but it was ignored.</li>
  <li><code>Install-Group's</code> <code>Members</code> parameter renamed to <code>Member</code> (with backwards-compatible alias).</li>
  <li>Added <code>Credential</code> parameter to <code>Install-IisAppPool</code> for increased security and to follow PowerShell guidelines.</li>
  <li><code>Install-IisVirtualDirectory</code> no longer deletes and re-creates existing virtual directories, but modifies existing virtual directories in place.</li>
  <li><code>Install-IisWebsite</code>
    <ul>
      <li>Added <code>SiteID</code> parameter tfor setting a website’s IIS ID.</li>
      <li>No longer deletes and re-creates websites, but modifies existing websites in place. This may or may not be a breaking change in your environment.</li>
    </ul>
  </li>
  <li><code>Install-Msi</code>
    <ul>
      <li><code>Path</code> parameter now supports wildcards.</li>
      <li>Now only installs an MSI if it isn’t already installed. To preserve the previous behavior and always install, add the <code>-Force</code> switch to all <code>Invoke-WindowsInstaller</code>`Install-Msi` usages.</li>
    </ul>
  </li>
  <li><code>Install-Service</code>
    <ul>
      <li>Now supports service startup parameters/arguments via the <code>ArgumentList</code> parameter.</li>
      <li>Improved error handling and messages. It now uses <code>net helpmsg</code> to get helpful error messages based on sc.exe exit codes.</li>
      <li>Added <code>Credential</code> parameter for increased security and to follow PowerShell guidelines.</li>
      <li>Added <code>Description</code> parameter for setting a service’s description.</li>
      <li>Added <code>DisplayName</code> parameter for setting a service’s display name.</li>
    </ul>
  </li>
  <li><code>Install-FileShare</code> (fka <code>Install-SmbShare</code>):
    <ul>
      <li>Re-written to use WMI isntead of <code>net.exe</code>, so it no longer returns any console output.</li>
      <li>Modifies existing shares in place, instead of deleting and re-creating, <em>unless</em> the share’s path changes. Changing a share’s path requires the old share to be deleted and a new one created.</li>
    </ul>
  </li>
  <li><code>Install-User</code>
    <ul>
      <li>Added <code>PasswordExpires</code> switch for creating accounts with passwords that expire.</li>
      <li>Added <code>UserCannotChangePassword</code> to prevent user from changing his password.</li>
    </ul>
  </li>
  <li><code>Remove-SslCertificateBinding</code> has better error handling.</li>
  <li>Added <code>SID</code> parameter to <code>Resolve-IdentityName</code> to resolve a SID into its identity name.</li>
  <li><code>Set-HostsEntry's</code> <code>IPAddress</code> parameter is now a <code>System.Net.IPAddress</code> object. It used to be a string validated with a regular expression.</li>
  <li><code>Set-RegistryKeyValue</code>: 
    <ul>
      <li>Added <code>UDWord</code> and <code>UQWord</code> parameters for setting registry key values to unsigned integers (i.e. integer values greater than <code>[int]::MaxValue</code> and <code>[long]::MaxValue</code>). Fixes <a href="https://bitbucket.org/splatteredbits/carbon/issues/165/set-registrykeyvalue">issue #165: Set-RegistryKeyValue rejects unsigned integers larger than [int]::MaxValue</a>.</li>
      <li>Deprecated <code>Quiet</code> switch.</li>
      <li>Only sets the value if the value doesn’t exist or the current value is different than the desired value. Use the <code>Force</code> parameter to preserve previous behavior.</li>
    </ul>
  </li>
  <li><code>Test-Identity</code> now returns a <code>Carbon.Identity</code> object if the identity exists <em>and</em> you use the <code>-PassThru</code> switch. It used to return the identity’s SID. Update scripts to use the <code>FullName</code> property to get the old return value, e.g. <code>Test-Identity -Name $userName -PassThru | Select-Object -Expand 'FullName'</code>.</li>
  <li><code>Test-OSIs32Bit</code> now uses the Environment class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitoperatingsystem.aspx">Is64BitOperatingSystem</a> property.</li>
  <li><code>Test-OSIs64Bit</code> now uses the Environment class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitoperatingsystem.aspx">Is64BitOperatingSystem</a> property.</li>
  <li><code>Test-PowerShellIs32Bit</code> now uses the <code>Environment</code> class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx">Is64BitProcess</a> property.</li>
  <li><code>Test-PowerShellIs64Bit</code> now uses the <code>Environment</code> class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx">Is64BitProcess</a> property.</li>
  <li><code>Uninstall-ScheduledTask</code> now retries when un-installing a task fails with “The function attempted to use a name that is reserved for use by another transaction.” error.</li>
  <li><code>Unprotect-String</code>
    <ul>
      <li>Added <code>AsSecureString</code> switch, which will return a secure string instead of a normal string.</li>
      <li>The <code>Password</code> parameter now accepts <code>SecureString</code> values.</li>
    </ul>
  </li>
  <li><code>Initialize-Lcm</code>
    <ul>
      <li>Added support for PowerShell 5: <code>RefreshIntervalMinutes</code> default value changed to from 15 to 30; <code>RefreshIntervalMinutes</code> minimum value is now 30; <code>ConfigurationFrequency</code>’s minimum value is now 1 (from 2).</li>
    </ul>
  </li>
</ul>

<h2 id="changes-since-alpha26">Changes Since <code>alpha.26</code></h2>

<h3 id="enhancements-1">Enhancements</h3>

<ul>
  <li>Includes all changes made in version 1.9.0.</li>
  <li>PowerShell 4 is now required. Carbon won’t even import under PowerShell 3.</li>
  <li>Removed <code>Carbon_Script</code> resource. It only existed so I could pass values to my script blocks. Turns out, the built-in <code>Script</code> resource supports this with the <code>$using:</code> scope. Remember, your most important features is documentation!</li>
  <li>Created a new <code>Carbon_ScheduledTask</code> DSC resource for managing scheduled tasks.</li>
  <li>The <code>Version</code> property on the objects returned by <code>Get-ProgramInstallInfo</code> is now a proper .NET <code>Version</code> object instead of an integer.</li>
</ul>

<h3 id="bug-fixes-1">Bug Fixes</h3>

<ul>
  <li><code>Carbon_Permission</code> DSC resource fails when assigning multiple permissions</li>
  <li>Grant-Permission fails when clearing multiple existing, non-inherited permission on an item.</li>
</ul>

<h2 id="changes-since-alpha31">Changes Since <code>alpha.31</code></h2>

<h3 id="bug-fixes-2">Bug Fixes</h3>

<ul>
  <li><code>Set-HostsEntry</code> fails to preserve whitespace if existing lines end with a comment/description. Thanks to <a href="https://vk.com/kostanew">Konstantin Ushenin</a> for the fix.</li>
  <li>Carbon’s <code>System.ServiceProcess.ServiceController</code> extended type data causes errors when PowerShell formats <code>System.ServiceProcess.ServiceController</code> objects that represent services on remote computers.</li>
  <li><code>Install-Msi</code> didn’t properly detect when installation failed.</li>
  <li><code>Set-EnvironmentVariable</code> fails to set process-level environment variable.</li>
  <li><code>Compress-Item</code> doesn’t remove handled errors from global error array.</li>
  <li><code>Grant-Permission</code> fails with an unhelpful error message if it is unable to get the ACL on a private key.</li>
</ul>

<h3 id="enhancements-2">Enhancements</h3>

<ul>
  <li><code>Import-Carbon.ps1</code> is more intelligent about when it tries to re-load Carbon. It will force a re-import of Carbon if any of Carbon’s files have changed or the version has changed.</li>
  <li>Created <code>Uninstall-Junction</code> for uninstalling a junction in an idempotent way (i.e. without errors). Thanks to <a href="https://vk.com/kostanew">Konstantin Ushenin</a> for the contribution.</li>
  <li>Improved error handling in <code>Remove-Junction</code>.</li>
  <li><code>Install-Service</code>:
    <ul>
      <li>Now supports service startup parameters/arguments.</li>
      <li>No longer returns <code>ServiceController</code> objects by default. This should improve backwards-compatability. Added a <code>PassThru</code> switch you can use to get a <code>ServiceController</code> object returned to you.</li>
      <li>Improved error handling. It now uses <code>net helpmsg</code> to get helpful error messages based on sc.exe exit codes.</li>
      <li>Improved handling of arguments/services with spaces in them under PowerShell 5.</li>
      <li>Added <code>Credential</code> parameter for increased security and to follow PowerShell guidelines.</li>
      <li>Now supports setting a service’s description and display name.</li>
      <li>Starting the service now respects caller’s error action preference. Before, <code>Start-Service</code> would write an error even if somone called <code>Install-Service</code> with an <code>Ignore</code> or <code>SilentlyContinue</code> error action preference.</li>
    </ul>
  </li>
  <li>New <code>Test-TypeDataMember</code> for testing if a type has an extended type member defined.</li>
  <li><code>Install-IisAppPool</code> no longer returns appcmd.exe output.</li>
  <li>Added <code>PassThru</code> parameter to <code>Install-IisAppPool</code> to control when a <code>Microsoft.Web.Administration.ApplicationPool</code> for the installed app pool is returned.</li>
  <li><code>Get-ServiceConfiguration</code> and Carbon’s extended type data for <code>System.ServiceProcess.ServiceController</code> objects now supports services from remote computers.</li>
  <li><code>Uninstall-ScheduledTask</code> now retries when un-installing a task fails with “The function attempted to use a name that is reserved for use by another transaction.” error.</li>
  <li>Added new <code>FileIndex</code>, <code>LinkCount</code>, and <code>VolumeSerialNumber</code> extended type data on <code>System.IO.FileInfo</code> objects for getting a file’s index, its hard link count, and volume serial number, respectively.</li>
  <li><code>Grant-Permission</code> now only returns an access rule object when the new <code>PassThru</code> switch is used. In previous 2.0 alpha releases, it only returned something when permissions on an object were added or changed.</li>
  <li><code>Install-User</code> only returns a user object when the new <code>PassThru</code> switch is used. In previous 2.0 alpha releases, it only returned an object if a user was created or updated.</li>
  <li><code>Grant-ComPermissions</code> only returns an access rule object when the new <code>PassThru</code> switch is used. In previous 2.0 alpha releases, it only returned an object if permissions were changed.</li>
  <li><code>Install-IisApplication</code> only returns an IIS application object when the new <code>PassThru</code> switch is used. In previous 2.0 alpha releases, it only returned an object if the application was created or modified.</li>
  <li>Created <code>Get-Msi</code> function for reading MSI information and properties from an MSI file.</li>
  <li><code>Carbon.Computer.ProgramInstallInfo</code> objects (returned from <code>Get-ProgramInstallInfo</code>) now have <code>ProductCode</code> and <code>User</code> properties. If a program doesn’t have a product code, it is set to <code>[Guid]::Empty</code>. The <code>User</code> property is only set for per-user software installs.</li>
  <li><code>Invoke-WindowsInstaller</code> renamed <code>Install-Msi</code>, with a backwards-compatibility-preserving alias.</li>
  <li><code>Install-Msi</code> now supports wildcards for MSI path to install.</li>
  <li><code>Install-Msi</code> now only installs an MSI if it isn’t already installed. To preserve the previous behavior and always install, add the <code>-Force</code> switch to all <code>Invoke-WindowsInstaller</code>`Install-Msi` usages.</li>
  <li>Added <code>SiteID</code> parameter to <code>Install-IisWebsite</code> for setting a website’s IIS ID.</li>
  <li>Put the <code>Resolve-IdentityName</code> function back. It was removed from previous alpha releases.</li>
  <li><code>Install-IisWebsite</code> no longer deletes and re-creates websites. This may or may not be a breaking change in your environment.</li>
  <li><code>Install-SmbShare</code> no longer returns net.exe output, instead writing it to the verbose stream. To see previous output, use the <code>-Verbose</code> switch.</li>
  <li>Changed <code>-PasswordNeverExpires</code> switch to  <code>PasswordExpires</code> on <code>Install-User</code> for improved backwards-compatability.</li>
  <li><code>Set-SslCertificateBinding</code> no longer returns binding objects by default. Use new <code>PassThru</code> switch to get the old behavior.</li>
  <li>The product version of the Carbon assembly now includes pre-release version information, as defined by the <a href="http://semver.org">Semantic Versioning specification</a>. To get this version, run <code>Get-Item Carbon.dll | Select-Object -ExpandProperty 'VersionInfo' | Select-Object -ExpandProperty 'ProductVersion'</code></li>
  <li>The Carbon NuGet package now supports installing and uninstalling using Chocolatey.</li>
  <li>Added <code>AsSecureString</code> switch to <code>Unprotect-String</code> which causes <code>Unprotect-String</code> to return a secure string instead of a normal string.</li>
  <li><code>Unprotect-String</code> now accepts a <code>SecureString</code> as the value for the <code>Password</code> parameter, which is the password for the private key used to decrypt from password-protected RSA certificate file.</li>
  <li>Added <code>Credential</code> parameter to <code>Install-IisAppPool</code> for increased security and to follow PowerShell guidelines.</li>
  <li>Added <code>Credential</code> parameter to <code>Install-User</code> for increased security and to follow PowerShell guidelines.</li>
  <li><code>Install-IisVirtualDirectory</code> now modifies existing virtual directories in place, instead of deleting and re-creating.</li>
  <li><code>Invoke-AppCmd</code> is now obsolete and will be removed from a future version of Carbon. Switch to Carbon’s IIS functions, or use <code>Get-IisConfigurationSection</code> to get <code>ConfigurationElement</code> objects from the <code>Microsoft.Web.Administration</code> API that you can modify.</li>
  <li>Added <code>Description</code> and <code>DisplayName</code> properties to <code>Carbon_Service</code> for setting a service’s description and display name.</li>
  <li><code>Grant-Permission</code> now writes an error if you don’t have access to a private key. Previously, it would skip the key without any messages.</li>
  <li><code>Resolve-Identity</code> now converts SIDs to a <code>Carbon.Identity</code> object. The SID may be a string (SID in SDDL form), byte array, or a <code>SecurityIdentifier</code> object.</li>
  <li><code>Get-FileSharePermission</code> gets the sharing permissions on a file/SMB share (<em>not</em> the NTFS file system permissions).</li>
  <li>Created <code>Get-FileShare</code> function. It uses WMI to get <code>Win32_Share</code> objects for the file shares installed on the local computer.</li>
  <li>Renamed <code>Install-SmbShare</code> to <code>Install-FileShare</code>, with a backwards-compatible alias in place.</li>
  <li>Added <code>SID</code> parameter to <code>Resolve-IdentityName</code> to resolve a SID into its identity name.</li>
  <li>Created <code>ConvertTo-SecurityIdentifer</code> function to convert a binary, string, or <code>System.Security.Principal.SecurityIdentifier</code> object into a <code>System.Security.Principal.SecurityIdentifier</code> object.</li>
  <li><code>Install-FileShare</code> (fka <code>Install-SmbShare</code>):
    <ul>
      <li>Re-written to use WMI isntead of <code>net.exe</code>.</li>
      <li>Modifies existing shares in place, instead of deleting and re-creating, <em>unless</em> the share’s path changes. Changing a share’s path requires the old share to be deleted and a new one created.</li>
    </ul>
  </li>
  <li><code>Carbon_FirewallRule</code> now fails with an error if it finds multiple firewall rules with the same name.</li>
  <li><code>Set-RegistryKeyValue</code>: 
    <ul>
      <li>Added <code>UDWord</code> and <code>UQWord</code> parameters for setting registry key values to unsigned integers (i.e. integer values greater than <code>[int]::MaxValue</code> and <code>[long]::MaxValue</code>). Fixes <a href="https://bitbucket.org/splatteredbits/carbon/issues/165/set-registrykeyvalue">issue #165: Set-RegistryKeyValue rejects unsigned integers larger than [int]::MaxValue</a>.</li>
      <li>Deprecated <code>Quiet</code> switch.</li>
      <li>Only sets value if the value is changed. Use the <code>Force</code> parameter to preserve previous behavior.</li>
    </ul>
  </li>
  <li><code>Uninstall-Service</code> no longer returns sc.exe stdout.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/11/carbon-1.9.0-released.html">Carbon 1.9.0 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-08T23:18:00-08:00" pubdate data-updated="true">Nov 8<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> 1.9 is out and is <a href="http://semver.org">backwards compatible</a> with 1.0 through 1.8.  It supports PowerShell 2 and 3.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads/Carbon-1.9.0.zip">Download from Bitbucket.</a></p>

<p>This is the last minor release for version 1.0. Future 1.0-compatible releases will <em>only</em> contain bug fixes, no new features. It takes too much time to maintain two versions, and I’d rather spend my time getting 2.0 out the door.  Carbon 2.0 will require PowerShell 4.0, so start planning.</p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Added <code>KeyStorageFlags</code> parameter to <a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> when loading a certificate from a file for better control when storing the certificate.</li>
</ul>

<h3 id="hosts-file">Hosts File</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-HostsEntry.html">Set-HostsEntry</a> now handles writing to an in-use/locked hosts file, retrying up to 10 times before writing an error, waiting a random amount of time (from 0 to 1000 milliseconds) between each retry attempt.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-IisMimeMap.html">Get-IisMimeMap</a>, <a href="http://get-carbon.org/help/Remove-IisMimeMap.html">Remove-IisMimeMap</a>, and <a href="http://get-carbon.org/help/Set-IisMimeMap.html">Set-IisMimeMap</a> now support managing MIME types for websites, virtual directories, and applications.</li>
</ul>

<h3 id="scheduled-tasks">Scheduled Tasks</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-ScheduledTask.html">Get-ScheduledTask</a> function for getting the scheduled tasks on the local computer using <code>schtasks.exe</code>.</li>
  <li>Created <a href="http://get-carbon.org/help/Install-ScheduledTask.html">Install-ScheduledTask</a> function for installing a scheduled task using <code>schtasks.exe</code>.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-ScheduledTask.html">Test-ScheduledTask</a> function for testing if a scheduled tasks on the local computer exists using <code>schtasks.exe</code>.</li>
  <li>Created <a href="http://get-carbon.org/help/Uninstall-ScheduledTask.html">Uninstall-ScheduledTask</a> function for deleting a scheduled task using <code>schtasks.exe</code>.</li>
</ul>

<h3 id="services">Services</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> now supports setting a command to run when a service fails.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="general">General</h3>

<ul>
  <li><code>Import-Carbon</code> fails when <code>-WhatIf</code> switch is used.</li>
  <li>Importing Carbon no longer writes an error if the <code>PATH</code> environment variable contains a path to a non-existent drive (issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/134/import-carbon-fails-with-path-environment">#134</a>).</li>
</ul>

<h3 id="ini">INI</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-IniEntry.html">Set-IniEntry</a> fails when adding the first section-less setting to a file.</li>
</ul>

<h3 id="internet-explorer">Internet Explorer</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Enable-IEActivationPermission.html">Enable-IEActivationPermission</a> no longer returns the <code>hkcr:</code> drive.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li>Fixed an error that occurs when setting permissions on a private key fails: the error message is created using an invalid format string (issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/133/set-cryptokeysecurity-invalid-parameters">#133</a>).</li>
  <li>Fixed an exception that gets thrown when setting a private key’s permissions and the only certificate key is AT_SIGNATURE (issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/132/set-cryptokeysecurity-throws-exception">#132</a>).</li>
</ul>

<h3 id="services-1">Services</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> stops Windows service even when no settings/configuration has changed (fixes issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/131/install-service-always-restarts-service">#131</a>). </li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> didn’t clear services depended on during a re-install.</li>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> wasn’t restarting a manual service if it was running when configuration began.</li>
  <li><a href="http://get-carbon.org/help/Uninstall-Service.html">Uninstall-Service</a> hard codes the path to the Windows directory (fixes issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/143/uninstall-service-script-has-hard-coded">#143</a>). Thanks to <a href="https://bitbucket.org/tdmathison">Travis Mathison</a> for the fix.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/09/carbon-2.0-alpha.26-released.html">Carbon 2.0-alpha.26 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-29T21:33:00-07:00" pubdate data-updated="true">Sep 29<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="overview">Overview</h2>

<p>Our first public alpha release of <a href="http://get-carbon.org">Carbon</a> 2.0 is out (version 2.0-alpha.26). The focus of version 2.0 is on making necessary, backwards-incompatible changes and <strong><em>adding DSC resources and functions</em></strong>. <a href="https://bitbucket.org/splatteredbits/carbon/issues?status=new&amp;status=open&amp;q=2.0">We still have some backwards-incompatible changes to make.</a> before we get to the final version of 2.0.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Download from BitBucket.</a></p>

<p>The highlight of this release are seven new DSC resources:</p>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_EnvironmentVariable.html">Carbon_EnvironmentVariable</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_FirewallRule.html">Carbon_FirewallRule</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_IniFile.html">Carbon_IniFile</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_Privilege.html">Carbon_Privilege</a> </li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_Permission.html">Carbon_Permission</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_Script.html">Carbon_Script</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Carbon_Service.html">Carbon_Service</a></li>
</ul>

<p>and these DSC-related functions:</p>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Clear-DscLocalResourceCache.html">Clear-DscLocalResourceCache</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Clear-MofAuthoringMetadata.html">Clear-MofAuthoringMetadata</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Copy-DscResource.html">Copy-DscResource</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Get-DscError.html">Get-DscError</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Get-DscWinEvent.html">Get-DscWinEvent</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Initialize-Lcm.html">Initialize-Lcm</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Start-DscPullConfiguration.html">Start-DscPullConfiguration</a></li>
  <li><a href="http://get-carbon.org/help/2.0/Test-DscTargetResource.html">Test-DscTargetResource</a> </li>
  <li><a href="http://get-carbon.org/help/2.0/Write-DscError.html">Write-DscError</a></li>
</ul>

<p>Enjoy!</p>

<h2 id="upgrade-instructions">Upgrade Instructions</h2>

<p>This is a backwards-incompatible release. </p>

<ul>
  <li>Upgrade to PowerShell 4. (PowerShell 3 <em>might</em> work. We don’t know because we don’t have any computers available to test on.)</li>
  <li>Remove usages of <code>Complete-Job</code>.  We removed it because it was total crap.  Use PowerShell’s <code>Wait-Job</code> cmdlet instead.</li>
  <li><a href="http://get-carbon.org/help/2.0/Grant-Permission.html">Grant-Permission</a> now only grants permissions on an object if those permissions aren’t present.  To preserve previous behaviour, add the <code>-Force</code> switch to all <code>Grant-Permission</code> usages.</li>
  <li>The following commands now return objects to the pipeline. Depending on your usage, you may need to pipe their output to <code>Out-Null</code>, assign their return values to <code>$null</code>, or do nothing.
    <ul>
      <li><a href="http://get-carbon.org/help/2.0/Grant-Permission.html">Grant-Permission</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Install-Group.html">Install-Group</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Install-Junction.html">Install-Junction</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Install-User.html">Install-User</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Grant-ComPermissions.html">Grant-ComPermissions</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Grant-ComPermissions.html">Install-Service</a></li>
    </ul>
  </li>
  <li>The following commands no longer return the stdout from various console applications. To see that output, use the <code>-Verbose</code> switch. Remove any usage of the output you were processing.
    <ul>
      <li><a href="http://get-carbon.org/help/2.0/Disable-FirewallStatefulFtp.html">Disable-FirewallStatefulFtp</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Enable-FirewallStatefulFtp.html">Enable-FirewallStatefulFtp</a></li>
      <li><a href="http://get-carbon.org/help/2.0/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a></li>
    </ul>
  </li>
  <li><a href="http://get-carbon.org/help/2.0/Set-SslCertificateBinding.html">Set-SslCertificateBinding</a> now returns <code>Carbon.Certificates.SslCertificateBinding</code> objects instead of netsh output. Update any code that uses the old <code>Set-SslCertificateBinding</code> output.</li>
  <li>Ensure that all thumbprints passed to <a href="http://get-carbon.org/help/2.0/Set-SslCertificateBinding.html">Set-SslCertificateBinding</a> are valid (40 character hex strings).</li>
  <li>Add the new <code>-PasswordNeverExpires</code> switch to usages of <a href="http://get-carbon.org/help/2.0/Install-User.html">Install-User</a>: it no longer sets the <code>PasswordNeverExpires</code> flag for a user by default.</li>
  <li>Use the <code>FullName</code> property on objects returned by <a href="http://get-carbon.org/help/2.0/Resolve-Identity.html">Resolve-Identity</a> (nAce <code>Resolve-IdentityName</code>): it now returns a <code>Carbon.Identity</code> object instead of the identity’s name, e.g. <code>Resolve-Identity -Name $userName | Select-Object -Expand 'FullName'</code>.</li>
  <li>Add <code>-ErrorAction SilentlyContinue</code> or <code>-ErrorAction Ignore</code> to usages of <a href="http://get-carbon.org/help/2.0/Resolve-Identity.html">Resolve-Identity</a> (nAce <code>Resolve-IdentityName</code>): it now writes an error if it can’t resolve a name.</li>
  <li>Use the <code>Sid</code> property on objects returned by <a href="http://get-carbon.org/help/2.0/Test-Identity.html">Test-Identity</a> when using the <code>PassThru</code> switch: it now returns a <code>Carbon.Identity</code> object if the identity exists <em>and</em> you use the <code>-PassThru</code> switch, e.g. <code>Test-Identity -Name $userName -PassThru | Select-Object -Expand 'Sid'</code>.</li>
  <li>Check that all IP addresses passed to <a href="http://get-carbon.org/help/2.0/Set-HostsEntry.html">Set-HostsEntry</a> are valid IP v4 or v6 addresses.  <a href="http://get-carbon.org/help/2.0/Set-HostsEntry.html">Set-HostsEntry</a>’s IPAddress parameter is now a <code>System.Net.IPAddress</code> object.  Previously it was a string validated with a regular expression, so you <em>should</em> be OK.</li>
  <li>Remove the <code>Exportable</code> switch from any usages of <a href="http://get-carbon.org/help/2.0/Install-Certificate.html">Install-Certificate</a> when installing from an <code>X509Certificate2</code> object, since that switch only gets used when installing a certificate from a file.</li>
  <li>Rename usages of <code>[Carbon.AdvApi32]</code> class to <code>[Carbon.Service.ServiceSecurity]</code>.</li>
  <li>Rename usages of <code>[Carbon.Lsa]</code> class to <code>[Carbon.Security.Privilege]</code>.</li>
  <li>Rename usages of <code>[Carbon.Win32]</code> class to <code>[Carbon.FileSystem.Path]</code>.</li>
  <li>Rename usages of <code>[Carbon.HandleInfo]</code> class to <code>[Carbon.Win32.HandleInfo]</code>.</li>
  <li>Remove usages of <code>[Carbon.Lsa]::LookupPrivilegeValue</code> class method. It was incorrectly exposed as a public method.</li>
  <li>Remove usages of <code>[Carbon.Kernel32]::LocalFree</code> class method. It was incorrectly exposed as a public method.</li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="certificates">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a> now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>. Improved error handling.</li>
  <li><a href="http://get-carbon.org/help/2.0/Remove-SslCertificateBinding.html">Set-SslCertificateBinding</a> now returns <code>Carbon.Certificates.SslCertificateBinding</code> object for the binding instead of <code>netsh</code> output. Improved error handling. Writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>. Thumbprints are now validated.</li>
  <li>The <code>Exportable</code> switch is now only allowed by <a href="http://get-carbon.org/help/2.0/Install-Certificate.html">Install-Certificate</a> when installing a certificate from a file. Previously, you could supply the switch when installing from an X509Certificate2 object but it was ignored.</li>
</ul>

<h3 id="com">COM</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Grant-ComPermission.html">Grant-ComPermission</a> now returns a <code>Carbon.Security.ComAccessRule</code>. Also, it now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>.</li>
  <li><a href="http://get-carbon.org/help/2.0/Revoke-ComPermission.html">Revoke-ComPermission</a> now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>.</li>
</ul>

<h3 id="computer">Computer</h3>

<ul>
  <li>Changed <a href="http://get-carbon.org/help/2.0/Test-OSIs32Bit.html">Test-OSIs32Bit</a> and <a href="http://get-carbon.org/help/2.0/Test-OSIs64Bit.html">Test-OSIs64Bit</a> functions to use the Environment class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitoperatingsystem.aspx">Is64BitOperatingSystem</a> property.</li>
</ul>

<h3 id="dsc">DSC</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_EnvironmentVariable.html">Carbon_EnvironmentVariable</a> resource for creating/removing machine-level environment variables.</li>
  <li>New <a href="http://get-carbon.org/help/2.0/Clear-DscLocalResourceCache.html">Clear-DscLocalResourceCache</a> function for clearing the local LCM’s DSC resource. This makes developing resources easier.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_IniFile.html">Carbon_IniFile</a> resource for managing settings in INI files.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_FirewallRule.html">Carbon_FirewallRule</a> resource for configuring firewall rules.</li>
  <li>New <a href="http://get-carbon.org/help/2.0/Test-DscTargetResource.html">Test-DscTargetResource</a> function for comparing target/desired resource states across DSC resources.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_Privilege.html">Carbon_Privilege</a> resource for configuring and identity’s privileges.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_Permission.html">Carbon_Permission</a> resource for configuring file, directory, registry, and certificate permissions.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_Service.html">Carbon_Service</a> resource for configuring Windows services.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Carbon_Script.html">Carbon_Script</a> resource for running custom PowerShell scripts, with support for passing arguments.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Copy-DscResource.html">Copy-DscResource</a> function for copying DSC resources (ZIP files, MSI archives, MOF files, etc.), including timestamps, checksums, and copying only changed files.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Clear-MofAuthoringMetadata.html">Clear-MofAuthoringMetadata</a> function for removing authoring metadata from .mof files.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Get-DscWinEvent.html">Get-DscWinEvent</a> function for getting DSC events written to a computer’s DSC event log.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Get-DscError.html">Get-DscError</a> function for getting any DSC errors written to a computer’s DSC event log.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Write-DscError.html">Write-DscError</a> function for writing DSC <code>ErrorLogRecord</code> objects as errors.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Start-DscPullConfiguration.html">Start-DscPullConfiguration</a> function for starting a configuration check on a computer whose computer is configured to use the PULL refresh mode.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Initialize-Lcm.html">Initialize-Lcm</a> function for configuring the DSC Local Configuration Manager on computers, including installing the private key needed for decrypting credentials.</li>
</ul>

<h3 id="file-system">File System</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Disable-NtfsCompression.html">Disable-NtfsCompression</a> now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>. Improved error handling.</li>
  <li><a href="http://get-carbon.org/help/2.0/Enable-NtfsCompression.html">Enable-NtfsCompression</a> now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>. Improved error handling.</li>
  <li><a href="http://get-carbon.org/help/2.0/Install-Junction.html">Install-Junction</a> now returns <code>System.IO.DirectoryInfo</code> objects for any new target directories and any new/updated junctions.</li>
</ul>

<h3 id="firewall">Firewall</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Disable-FirewallStatefulFtp.html">Disable-FirewallStatefulFtp</a> no longer returns <code>netsh</code> output. Use the <code>-Verbose</code> switch to see the output.</li>
  <li><a href="http://get-carbon.org/help/2.0/Enable-FirewallStatefulFtp.html">Enable-FirewallStatefulFtp</a> no longer returns <code>netsh</code> output. Use the <code>-Verbose</code> switch to see the output.</li>
</ul>

<h3 id="hosts-file">Hosts File</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Set-HostsEntry.html">Set-HostsEntry</a>’s IPAddress parameter is now a <code>System.Net.IPAddress</code> object.  Previously it was a string validated with a regular expression.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li>Changed <a href="http://get-carbon.org/help/2.0/Test-PowerShellIs32Bit.html">Test-PowerShellIs32Bit</a> and <a href="http://get-carbon.org/help/2.0/Test-PowerShellIs64Bit.html">Test-PowerShellIs64Bit</a> functions to use the Environment class’s new <a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx">Is64BitProcess</a> property.</li>
  <li>Removed <code>Complete-Job</code> function.  It was total crap.</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Get-PowerShellModuleInstallPath.html">Get-PowerShellModuleInstallPath</a> function for getting the path where new module’s should be installed. Beginning with PowerShell 4, modules should get installed into <code>$env:ProgramFiles\Windows PowerShell\Modules</code>. Under PowerShell 3, it is <code>$PSHome\Modules</code>. This function returns the correct location for the version of PowerShell you’re using.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Grant-Permission.html">Grant-Permission</a> now only grants permissions on an object if those permissions aren’t present.  To preserve previous behaviour, add the <code>-Force</code> switch to all <code>Grant-Permission</code> usages.</li>
  <li><a href="http://get-carbon.org/help/2.0/Grant-Permission.html">Grant-Permission</a> returns <code>System.Security.AccessControl.FileSystemRule</code> or <code>System.Security.AccessControl.RegistryRule</code> whenever it updates an item’s permissions.  It no longer writes a message to the host.</li>
</ul>

<h3 id="service">Service</h3>

<ul>
  <li><a href="http://get-carbon.org/help/2.0/Grant-ComPermissions.html">Install-Service</a> now writes messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>.</li>
  <li><a href="http://get-carbon.org/help/2.0/Grant-ComPermissions.html">Install-Service</a> now returns a <code>System.ServiceProcess.ServiceController</code> object when installation/configuration is successful.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li>Re-wrote <a href="http://get-carbon.org/help/2.0/Install-User.html">Install-User</a> to use .NET’s <a href="http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx">System.DirectoryServices.AccountManagement</a> API (introduced with .NET 3.5) instead of the <code>net.exe</code> command-line program.</li>
  <li>Added <code>PasswordNeverExpires</code> switch to <a href="http://get-carbon.org/help/2.0/Install-User.html">Install-User</a> for creating accounts with passwords that expire.  This is a breaking change: this flag used to set this flag by default.</li>
  <li>Added <code>UserCannotChangePassword</code> switch to <a href="http://get-carbon.org/help/2.0/Install-User.html">Install-User</a> to prevent user from changing his password.</li>
  <li>Added <a href="http://get-carbon.org/help/2.0/Get-User.html">Get-User</a> function for getting a local user or all local users.</li>
  <li>Added <a href="http://get-carbon.org/help/2.0/Get-Group.html">Get-Group</a> function for getting a local group or all local groups.</li>
  <li>Renamed <a href="http://get-carbon.org/help/2.0/Install-Group.html">Install-Group</a>’s <code>Members</code> parameter to <code>Member</code> (with backwards-compatible alias).</li>
  <li><a href="http://get-carbon.org/help/2.0/Install-Group.html">Install-Group</a> re-written to use .NET’s <code>System.DirectoryServices.AccountManagement</code> API (introduced with .NET 3.5).</li>
  <li><a href="http://get-carbon.org/help/2.0/Install-Group.html">Install-Group</a> now returns the group added or updated.</li>
  <li><a href="http://get-carbon.org/help/2.0/Add-MemberToGroup.html">Add-MemberToGroup</a> re-written to use .NET’s <code>System.DirectoryServices.AccountManagement</code> API (introduced with .NET 3.5).</li>
  <li><a href="http://get-carbon.org/help/2.0/Resolve-IdentityName.html">Resolve-IdentityName</a> now writes an error if it can’t resolve a name.  Use <code>-ErrorAction SilentlyContinue</code> or <code>-ErrorAction Ignore</code> to preserve old behavior.</li>
  <li><a href="http://get-carbon.org/help/2.0/Uninstall-User.html">Uninstall-User</a> re-written to use .NET’s <code>System.DirectoryServices.AccountManagement</code> API (introduced with .NET 3.5).</li>
  <li><a href="http://get-carbon.org/help/2.0/Test-User.html">Test-User</a> re-written to use .NET’s <code>System.DirectoryServices.AccountManagement</code> API (introduced with .NET 3.5).</li>
  <li>Created <a href="http://get-carbon.org/help/2.0/Test-Group.html">Test-Group</a> function for checking if a <em>local</em> group exists.</li>
  <li><code>Resolve-IdentityName</code> renamed to <a href="http://get-carbon.org/help/2.0/Resolve-Identity.html">Resolve-Identity</a>, but it has a backwards-compatible alias, so you shouldn’t have to do anything.</li>
  <li><a href="http://get-carbon.org/help/2.0/Resolve-Identity.html">Resolve-Identity</a> (nAce <code>Resolve-IdentityName</code>) now returns a <code>Carbon.Identity</code> object instead of the identity’s name.  Update scripts to use the <code>FullName</code> property to get the old return value, e.g. <code>Resolve-Identity -Name $userName -PassThru | Select-Object -Expand 'FullName'</code>.</li>
  <li><a href="http://get-carbon.org/help/2.0/Resolve-Identity.html">Resolve-Identity</a> (nAce <code>Resolve-IdentityName</code>) now writes an error if it can’t resolve a name.  Use <code>-ErrorAction SilentlyContinue</code> or <code>-ErrorAction Ignore</code> to preserve old behavior.</li>
  <li><a href="http://get-carbon.org/help/2.0/Test-Identity.html">Test-Identity</a> now returns a <code>Carbon.Identity</code> object if the identity exists <em>and</em> you use the <code>-PassThru</code> switch.  It used to return the identity’s name.  Update scripts to use the <code>FullName</code> property to get the old return value, e.g. <code>Test-Identity -Name $userName -PassThru | Select-Object -Expand 'FullName'</code>.</li>
  <li>Added <a href="http://get-carbon.org/help/2.0/Remove-GroupMember.html">Remove-GroupMember</a> function. Thanks to <a href="https://bitbucket.org/philkloose">Philip Kluss</a> for the contribution. </li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/09/carbon-1.8-released.html">Carbon 1.8 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-07T10:14:00-07:00" pubdate data-updated="true">Sep 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> 1.8 is out and is <a href="http://semver.org">backwards compatible</a> with 1.0 through 1.7.  It supports PowerShell 2 and 3. Highlights include:</p>

<ul>
  <li>Carbon now uses <code>Write-Verbose</code> instead of <code>Write-Host</code>.</li>
  <li>New functions:
    <ul>
      <li><a href="http://get-carbon.org/help/Get-ProgramInstallInfo.html">Get-ProgramInstallInfo</a> (gets installed programs)</li>
      <li><a href="http://get-carbon.org/help/New-RsaKeyPair.html">New-RsaKeyPair</a> (generates RSA public/private key pair)</li>
      <li><a href="http://get-carbon.org/help/Revoke-Permission.html">Revoke-Permission</a> (revokes permissions)</li>
      <li><a href="http://get-carbon.org/help/Get-ServiceConfiguration.html">Get-ServiceConfiguration</a> (gets extended service information: username, failure actions, etc.)</li>
      <li><a href="http://get-carbon.org/help/Compress-Item.html">Compress-Item</a> (create ZIP file)</li>
      <li><a href="http://get-carbon.org/help/Test-ZipFile.html">Test-ZipFile</a> (tests if a file is a ZIP file)</li>
      <li><a href="http://get-carbon.org/help/Expand-Item.html">Expand-Item</a> (decompresses ZIP file)</li>
    </ul>
  </li>
  <li><a href="http://get-carbon.org/help/Get-Permission.html">Get-Permission</a>, <a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a>, and <a href="http://get-carbon.org/help/Test-Permission.html">Test-Permission</a> now supports certificate private keys/key containers.</li>
  <li><a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a> now returns additional rule information: interface type, security, source, description, program, and service.</li>
  <li>Lots of improved error handling.</li>
  <li>Some bug fixes.</li>
</ul>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>The following functions now write messages with <code>Write-Verbose</code> instead of <code>Write-Host</code>. See <a href="http://www.jsnover.com/blog/2013/12/07/write-host-considered-harmful/">Write-Host Considered Harmful</a>.
    <ul>
      <li><a href="http://get-carbon.org/help/Add-GroupMember.html">Add-GroupMember</a></li>
      <li><a href="http://get-carbon.org/help/Clear-TrustedHost.html">Clear-TrustedHost</a></li>
      <li><a href="http://get-carbon.org/help/Convert-XmlFile.html">Convert-XmlFile</a></li>
      <li><a href="http://get-carbon.org/help/Disable-FirewallStatefulFtp.html">Disable-FirewallStatefulFtp</a></li>
      <li><a href="http://get-carbon.org/help/Disable-IEEnhancedSecurityConfiguration.html">Disable-IEEnhancedSecurityConfiguration</a></li>
      <li><a href="http://get-carbon.org/help/Disable-IisSecurityAuthentication.html">Disable-IisSecurityAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Disable-NtfsCompression.html">Disable-NtfsCompression</a></li>
      <li><a href="http://get-carbon.org/help/Enable-FirewallStatefulFtp.html">Enable-FirewallStatefulFtp</a></li>
      <li><a href="http://get-carbon.org/help/Enable-IEActivationPermission.html">Enable-IEActivationPermission</a></li>
      <li><a href="http://get-carbon.org/help/Enable-IisSecurityAuthentication.html">Enable-IisSecurityAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Enable-NtfsCompression.html">Enable-NtfsCompression</a></li>
      <li><a href="http://get-carbon.org/help/Grant-ComPermission.html">Grant-ComPermission</a></li>
      <li><a href="http://get-carbon.org/help/Grant-MsmqMessageQueuePermission.html">Grant-MsmqMessageQueuePermission</a></li>
      <li><a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a></li>
      <li><a href="http://get-carbon.org/help/Grant-ServiceControlPermission.html">Grant-ServiceControlPermission</a></li>
      <li><a href="http://get-carbon.org/help/Install-Group.html">Install-Group</a></li>
      <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a></li>
      <li><a href="http://get-carbon.org/help/Install-MsmqMessageQueue.html">Install-MsmqMessageQueue</a></li>
      <li><a href="http://get-carbon.org/help/Install-PerformanceCounter.html">Install-PerformanceCounter</a></li>
      <li><a href="http://get-carbon.org/help/Install-RegistryKey.html">Install-RegistryKey</a></li>
      <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a></li>
      <li><a href="http://get-carbon.org/help/Install-User.html">Install-User</a></li>
      <li><a href="http://get-carbon.org/help/Install-WindowsFeature.html">Install-WindowsFeature</a></li>
      <li><a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a></li>
      <li><a href="http://get-carbon.org/help/Lock-IisConfigurationSection.html">Lock-IisConfigurationSection</a></li>
      <li><a href="http://get-carbon.org/help/New-Junction.html">New-Junction</a></li>
      <li><a href="http://get-carbon.org/help/Protect-Acl.html">Protect-Acl</a></li>
      <li><a href="http://get-carbon.org/help/Remove-IniEntry.html">Remove-IniEntry</a> </li>
      <li><a href="http://get-carbon.org/help/Remove-Junction.html">Remove-Junction</a></li>
      <li><a href="http://get-carbon.org/help/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a></li>
      <li><a href="http://get-carbon.org/help/Reset-HostsFile.html">Reset-HostsFile</a></li>
      <li><a href="http://get-carbon.org/help/Reset-MsmqQueueManagerID.html">Reset-MsmqQueueManagerID</a></li>
      <li><a href="http://get-carbon.org/help/Revoke-ComPermission.html">Revoke-ComPermission</a></li>
      <li><a href="http://get-carbon.org/help/Revoke-ServicePermission.html">Revoke-ServicePermission</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisHttpHeader.html">Set-IisHttpHeader</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisMimeMap.html">Set-IisMimeMap</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisWebsiteID.html">Set-IisWebsiteID</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisWindowsAuthentication.html">Set-IisWindowsAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Set-IniEntry.html">Set-IniEntry</a></li>
      <li><a href="http://get-carbon.org/help/Set-RegistryKeyValue.html">Set-RegistryKeyValue</a></li>
      <li><a href="http://get-carbon.org/help/Set-SslCertificateBinding.html">Set-SslCertificateBinding</a></li>
      <li><a href="http://get-carbon.org/help/Uninstall-IisAppPool.html">Uninstall-IisAppPool</a></li>
      <li><a href="http://get-carbon.org/help/Uninstall-WindowsFeature.html">Uninstall-WindowsFeature</a></li>
      <li><a href="http://get-carbon.org/help/Unlock-IisConfigurationSection.html">Unlock-IisConfigurationSection</a></li>
    </ul>
  </li>
  <li>The following internal functions (which we warned you not to use!) are no longer exported:
    <ul>
      <li>Add-IisServerManagerMember</li>
      <li>Get-IdentityPrincipalContext</li>
      <li>Invoke-ConsoleCommand</li>
      <li>ConvertTo-ProviderAccessControlRights</li>
      <li>Assert-WindowsFeatureFunctionsSupported</li>
      <li>Resolve-WindowsFeatureName</li>
    </ul>
  </li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li>Improving error handling when <a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> fails to load a certificate from a file.</li>
  <li><a href="http://get-carbon.org/help/Install-Certificate.html">Install-Certificate</a> now supports installing with an <code>X509Certificate2</code> object instead of just a path to a certificate.</li>
  <li><a href="http://get-carbon.org/help/Remove-SslCertificateBinding.html">Remove-SslCertificateBinding</a>: improved error handling.</li>
  <li><a href="http://get-carbon.org/help/Set-SslCertificateBinding.html">Set-SslCertificateBinding</a>: improved error handling.</li>
  <li>Improved documentation for <a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a>.</li>
  <li>Added extended script property <code>StoreName</code> to <code>X509Store</code> objects to return the store’s <code>System.Security.Cryptography.X509Certificates.StoreName</code> value.</li>
  <li>Added a table view/format for <code>X509Store</code> objects. PowerShell’s default view is a list, so you’ll have to explicitly format the objects as a table, e.g. <code>dir cert:\LocalMachine | Format-Table</code>.</li>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a>’s <code>Path</code> parameter now supports wildcards and certificate provider paths, e.g. <code>cert:\</code>.</li>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> now writes an error if a certificate isn’t found when getting a certificate by its path.</li>
</ul>

<h3 id="computer">Computer</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-ProgramInstallInfo.html">Get-ProgramInstallInfo</a> function to get the information displayed by the <code>Programs and Features</code> UI.</li>
</ul>

<h3 id="cryptography">Cryptography</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Protect-String.html">Protect-String</a> can now encrypt strings as a specific user. Use the <code>Credential</code> parameter.</li>
  <li>Created <a href="http://get-carbon.org/help/New-RsaKeyPair.html">New-RsaKeyPair</a> for creating public/private RSA key pair using <code>makecert.exe</code> and <code>pkv2pfx.exe</code>. Requires that you’ve installed a Windows SDK.</li>
  <li><a href="http://get-carbon.org/help/Protect-String.html">Protect-String</a> can now encrypt strings using an RSA public key.</li>
  <li><a href="http://get-carbon.org/help/Unprotect-String.html">Unprotect-String</a> can now decrypt strings using an RSA private key.</li>
</ul>

<h3 id="file-system">File System</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Disable-NtfsCompression.html">Disable-NtfsCompression</a>: improved error handling.</li>
  <li><a href="http://get-carbon.org/help/Enable-NtfsCompression.html">Enable-NtfsCompression</a>: improved error handling.</li>
  <li>Created <a href="http://get-carbon.org/help/Compress-Item.html">Compress-Item</a> function for compressing files/directories into a ZIP file.</li>
  <li>Created <a href="http://get-carbon.org/help/Test-ZipFile.html">Test-ZipFile</a> function for testing if a file is a ZIP file.</li>
  <li>Created <a href="http://get-carbon.org/help/Expand-Item.html">Expand-Item</a> function for decompressing a ZIP file.</li>
  <li><a href="http://get-carbon.org/help/New-TempDirectory.html">New-TempDirectory</a> now supports adding a prefix to the temporary directory’s name, so you can more easily track down those scripts/processes that don’t clean up after themselves.</li>
</ul>

<h3 id="firewall">Firewall</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Disable-FirewallStatefulFtp.html">Disable-FirewallStatefulFtp</a>: improved error handling.</li>
  <li>Added <code>Name</code> and <code>LiteralName</code> parameters to <a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a> to return specific rules instead of all of them.</li>
  <li><a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a>, now returns <code>Carbon.Firewall.Rule</code> objects, instead of anonymous hashes.</li>
  <li>Added default table format for <a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a> output.</li>
  <li><a href="http://get-carbon.org/help/Get-FirewallRule.html">Get-FirewallRule</a> now returns additional rule information: interface type, security, source, description, program, and service. Who knew <code>netsh advfirewall firewall rule show</code> had a <code>verbose</code> switch? RTFM.</li>
</ul>

<h3 id="ini">INI</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Remove-IniEntry.html">Remove-IniEntry</a> now handles case-sensitive INI files.</li>
  <li><a href="http://get-carbon.org/help/Set-IniEntry.html">Set-IniEntry</a> now handles case-sensitive INI files.</li>
  <li><a href="http://get-carbon.org/help/Split-Ini.html">Split-Ini</a> now handles case-sensitive INI files.</li>
</ul>

<h3 id="msi">MSI</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-WindowsInstaller.html">Invoke-WindowsInstaller</a>: improved error message if installation fails.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li>Creating <a href="http://get-carbon.org/help/Revoke-Permission.html">Revoke-Permission</a> function for revoking a user’s permission to a file, directory, registry key, or certificate’s private key/key container.</li>
  <li>Creating <a href="http://get-carbon.org/help/ConvertTo-ContainerInheritanceFlags.html">ConvertTo-ContainerInheritanceFlags</a> function for converting  <code>System.Security.AccessControl.InheritanceFlags</code> and <code>System.Security.AccessControl.PropagationFlag</code> values into a <code>Carbon.Security.ContainerInheritanceFlags</code> value.</li>
  <li><a href="http://get-carbon.org/help/Get-Permission.html">Get-Permission</a> now supports returning the permissions on private keys/key containers.</li>
  <li><a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a> now supports granting permissions on private keys//key containers.</li>
  <li><a href="http://get-carbon.org/help/Test-Permission.html">Test-Permission</a> now supports testing permissions on certificate private keys/key containers.</li>
</ul>

<h3 id="services">Services</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-ServiceConfiguration.html">Get-ServiceConfiguration</a> function for loading a service’s configuration: description, account name/username, failure actions, etc.</li>
  <li>Added the following extended type data to <code>System.ServiceController.Service</code>:
    <ul>
      <li>Description</li>
      <li>ErrorControl</li>
      <li>FailureProgram</li>
      <li>FirstFailure</li>
      <li>LoadOrderGroup</li>
      <li>Path</li>
      <li>RebootDelay</li>
      <li>RebootDelayMinutes</li>
      <li>RebootMessage</li>
      <li>ResetPeriod</li>
      <li>ResetPeriodDays</li>
      <li>RestartDelay</li>
      <li>RestartDelayMinutes</li>
      <li>SecondFailure</li>
      <li>StartMode</li>
      <li>StartType</li>
      <li>TagID</li>
      <li>ThirdFailure</li>
      <li>UserName</li>
    </ul>
  </li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="general-1">General</h3>

<ul>
  <li>Importing Carbon gives an error if <code>PATH</code> environment variable contains an empty path.</li>
  <li>Improved the error handling in the following functions so they properly catch exceptions and write friendlier errors:
    <ul>
      <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a></li>
      <li><a href="http://get-carbon.org/help/Grant-Privilege.html">Grant-Privilege</a></li>
      <li><a href="http://get-carbon.org/help/Revoke-Privilege.html">Revoke-Privilege</a></li>
    </ul>
  </li>
</ul>

<h3 id="certificates-1">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> couldn’t open CA/CertificateAuthority store (fixes issue <a href="https://bitbucket.org/splatteredbits/carbon/issue/130/get-certificate-doesnt-find-any">#130</a>).</li>
  <li>Extended script property <code>DisplayName</code> on <code>X509Store</code> objects returning wrong store name for custom stores, now returns an empty string.</li>
</ul>

<h3 id="file-system-1">File System</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Disable-NtfsCompression.html">Disable-NtfsCompression</a> now <em>really</em> supports multiple paths.</li>
  <li><a href="http://get-carbon.org/help/Enable-NtfsCompression.html">Enable-NtfsCompression</a> now <em>really</em> supports multiple paths.</li>
</ul>

<h3 id="path">Path</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Resolve-PathCase.html">Resolve-PathCase</a> didn’t work under Windows 2012 R2.</li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li>The <code>Carbon.Identity.FindByName</code> method and the <a href="http://get-carbon.org/help/Resolve-IdentityName.html">Resolve-IdentityName</a> and <a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> functions now handle identity names with <code>.</code> for the domain/machine name, e.g. <code>.\Administrator</code>.</li>
  <li>The <code>Carbon.Identity.FullName</code> property returns the wrong value when domain is empty/null, e.g. <code>Resolve-IdentityName -Name 'Everyone'</code> returns <code>\Everyone</code>, when it should return <code>Everyone</code>.</li>
  <li>The <code>Carbon.Identity.FindByName</code> method and the <a href="http://get-carbon.org/help/Resolve-IdentityName.html">Resolve-IdentityName</a> and <a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> functions unable to resolve <code>LocalSystem</code> account (which is actually <code>NT AUTHORITY\SYSTEM</code>).</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/04/carbon-1-dot-7-released.html">Carbon 1.7 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-30T13:40:00-07:00" pubdate data-updated="true">Apr 30<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> 1.7 is out and is <a href="http://semver.org">backwards compatible</a> with 1.0 through 1.6.  It supports PowerShell 2. It contains mostly bug fixes and some enhancements.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<p>There is now <a href="http://www.freelists.org/list/carbon">a Carbon support mailing list</a>.</p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="general">General</h3>

<ul>
  <li>Import-Carbon.ps1 now supports the <code>-WhatIf</code> switch.</li>
  <li>Import-Carbon.ps1 now hides verbose log messages when removing/importing Carbon even when supplying the <code>-Verbose</code> switch because I think the verbose output is too verbose and not helpful at all.</li>
  <li>Import-Carbon.ps1 now supports adding a prefix when importing the Carbon module (with the <code>Prefix</code> parameter) to avoid name collisions and <a href="http://blogs.msdn.com/b/powershell/archive/2014/04/07/what-s-in-a-name-using-the-ps-prefix.aspx">follow best practices</a>.</li>
</ul>

<h3 id="certificates">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-CertificateStore.html">Get-CertificateStore</a> now supports non-standard, custom certificate stores.</li>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> now supports non-standard, custom certificate stores.</li>
  <li><a href="http://get-carbon.org/help/Install-Certificate.html">Install-Certificate</a> now supports non-standard, custom certificate stores.</li>
  <li><a href="http://get-carbon.org/help/Uninstall-Certificate.html">Uninstall-Certificate</a> now supports non-standard, custom certificate stores.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="general-1">General</h3>

<ul>
  <li>No more silent errors when importing Carbon on Windows 2012 R2.</li>
</ul>

<h3 id="certificates-1">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> no longer writes a silent error when a certificate does not exist. Instead, no error is written.</li>
</ul>

<h3 id="file-system">File System</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-Junction.html">Install-Junction</a> fails when target path is hidden.</li>
  <li><a href="http://get-carbon.org/help/Test-NtfsCompression.html">Test-NtfsCompression</a> fails when file/directory is hidden.</li>
  <li><a href="http://get-carbon.org/help/Test-PathIsJunction.html">Test-PathIsJunction</a> fails when tested directory is hidden.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a> fails when item is hidden.</li>
  <li><a href="http://get-carbon.org/help/Grant-Permission.html">Grant-Permission</a> doesn’t handle non-existent paths, causing cascading errors.</li>
  <li><a href="http://get-carbon.org/help/Test-Permission.html">Test-Permission</a> always returns <code>$false</code> when testing leaf-level permissions and the <code>ApplyTo</code> parameter is provided, i.e. it doesn’t ignore inheritance/propagation flags on leaves.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/carbon-1-dot-6-released.html">Carbon 1.6 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-01T12:14:00-08:00" pubdate data-updated="true">Feb 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> 1.6 is out and is <a href="http://semver.org">backwards compatible</a> with 1.0 through 1.5.1.  It supports PowerShell 2.  It contains a few bug fixes and many enhancements.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="file-system">File System</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Remove-Junction.html">Remove-Junction</a> doesn’t delete a junction when given a relative path to the junction.</li>
</ul>

<h3 id="services">Services</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-Service.html">Install-Service</a> doesn’t properly resolve a service’s path.</li>
</ul>

<h3 id="shares">Shares</h3>

<ul>
  <li>Fixed <a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> example to use correct syntax. <a href="https://bitbucket.org/splatteredbits/carbon/issue/111">#111.</a></li>
</ul>

<h2 id="enhancements">Enhancements</h2>

<h3 id="hosts-file">Hosts File</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Remove-HostsEntry.html">Remove-HostsEntry</a> function for removing hostnames from a hosts file.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Join-IisVirtualPath.html">Join-IisVirtualPath</a> for joining paths used by the IIS APIs.</li>
  <li>Renamed all IIS <code>Path</code> parameters which represented virtual paths to <code>VirtualPath</code> (with backwards-compatible aliases):
    <ul>
      <li><a href="http://get-carbon.org/help/Disable-IisSecurityAuthentication.html">Disable-IisSecurityAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Enable-IisDirectoryBrowsing.html">Enable-IisDirectoryBrowsing</a></li>
      <li><a href="http://get-carbon.org/help/Enable-IisSecurityAuthentication.html">Enable-IisSecurityAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Enable-IisSsl.html">Enable-IisSsl</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisApplication.html">Get-IisApplication</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisConfigurationSection.html">Get-IisConfigurationSection</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisHttpHeader.html">Get-IisHttpHeader</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisHttpRedirect.html">Get-IisHttpRedirect</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisMimeMap.html">Get-IisMimeMap</a></li>
      <li><a href="http://get-carbon.org/help/Get-IisSecurityAuthentication.html">Get-IisSecurityAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisHttpHeader.html">Set-IisHttpHeader</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisHttpRedirect.html">Set-IisHttpRedirect</a></li>
      <li><a href="http://get-carbon.org/help/Set-IisWindowsAuthentication.html">Set-IisWindowsAuthentication</a></li>
      <li><a href="http://get-carbon.org/help/Test-IisConfigurationSection.html">Test-IisConfigurationSection</a></li>
      <li><a href="http://get-carbon.org/help/Test-IisSecurityAuthentication.html">Test-IisSecurityAuthentication</a></li>
    </ul>
  </li>
  <li>Renamed <a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a>’s <code>SiteName</code> parameter to <code>Name</code> (with a backwards-compatible alias).</li>
  <li>Renamed all IIS <code>Name</code> parameters which represented virtual paths to <code>VirtualPath</code> (with backwards-compatible aliases):
    <ul>
      <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a></li>
      <li><a href="http://get-carbon.org/help/Install-IisVirtualDirectory.html">Install-IisVirtualDirectory</a></li>
    </ul>
  </li>
  <li>Renamed all IIS <code>Path</code> parameters which represented physical paths to <code>PhysicalPath</code> (with backwards-compatible aliases):
    <ul>
      <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a></li>
      <li><a href="http://get-carbon.org/help/Install-IisVirtualDirectory.html">Install-IisVirtualDirectory</a></li>
      <li><a href="http://get-carbon.org/help/Install-IisWebsite.html">Install-IisWebsite</a></li>
    </ul>
  </li>
</ul>

<h3 id="net">.NET</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Test-DotNet.html">Test-DotNet</a> for testing if v2 or v4 of the .NET framework is installed.</li>
</ul>

<h3 id="path">Path</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Get-PathProvider.html">Get-PathProvider</a> function for getting a path’s PowerShell provider.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li>Updated <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> to test if the appropriate .NET framework is installed if the user chooses an explicit runtime to use.</li>
</ul>

<h3 id="security">Security</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Test-Permission.html">Test-Permission</a> function for checking if a user/group has a set of permissions and, optionally, a set of inheritance and propagation flags on a file, directory, or registry key.</li>
  <li><a href="http://get-carbon.org/help/Test-Permission.html">Test-Permission</a> now automatically includes the <code>Synchronize</code> permission when checking for exact permissions, since this permission is always on and can never be removed from a file/directory.</li>
</ul>

<h3 id="services-1">Services</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-User.html">Install-Service</a> no longer requires a password, in order to support <a href="http://technet.microsoft.com/en-us/library/dd548356.aspx">managed service accounts and virtual accounts</a>.  We have no idea if this works, since we can’t test locally.  Please let us know if this fix works for you. <a href="https://bitbucket.org/splatteredbits/carbon/issue/114">#114</a></li>
</ul>

<h3 id="users-and-groups">Users and Groups</h3>

<ul>
  <li>Updated <a href="http://get-carbon.org/help/Install-User.html">Install-User</a> to support passwords longer than 14 characters.  Thanks to <a href="http://www.jamescrowley.co.uk/">James Crowley</a> for the fix.</li>
</ul>

<h3 id="windows-features">Windows Features</h3>

<ul>
  <li>Marked Assert-WindowsFeatureFunctionsSupported as an internal function.  Please don’t use.  It will be removed from future versions of PowerShell.</li>
  <li>Updated <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Test-WindowsFeature</a> to work on Windows 8/2012.</li>
  <li>Created new <code>Carbon.Identity</code> class for representing identities.  It also contains a static <code>FindByName</code> method which uses The Windows <code>LookupAccountName</code> function to find full account names, domains, and sids.  </li>
  <li>Updated <a href="http://get-carbon.org/help/Test-Identity.html">Test-Identity</a> to use <code>[Carbon.Identity]::FindByName</code> to find identities so it no longer throws exceptions when an identity can’t be found.</li>
  <li>Updated <a href="http://get-carbon.org/help/Resolve-IdentityName.html">Resolve-IdentityName</a> to use <code>[Carbon.Identity]::FindByName</code> to find identities so it no longer throws exceptions when an identity can’t be found.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/10/carbon-v151-released.html">Carbon v1.5.1 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-03T16:10:00-07:00" pubdate data-updated="true">Oct 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.5.1 is out and is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.5.  It supports PowerShell 2.  It contains two bug fixes.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="iis">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-IisWebsiteID.html">Set-IisWebsiteID</a> wasn’t consistently starting a website after changing its ID.</li>
</ul>

<h3 id="shares">Shares</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> writes an error when running under strict mode.  (It has an unused variable which uses an undefined variable to create its value.  Removed the unused variable.)</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/09/carbon-v15-released.html">Carbon v1.5 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-06T09:35:00-07:00" pubdate data-updated="true">Sep 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.5 is out and is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.4.  This release adds a few new features and some bug fixes to improve PowerShell 3 support.</p>

<p>This is definitely the last release to support PowerShell 2.  There were enough bug fixes that I didn’t feel good about making people upgrade to a backwards-incompatible version to get them, so I jumped through some extra hoops to test on PowerShell 2.  You’re welcome.  <code>;-)</code></p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="iis">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-IisWebsiteID.html">Set-IisWebsiteID</a> now attempts to start a website whose ID has changed, since IIS stops a website whenever its ID changes.</li>
</ul>

<h3 id="network">Network</h3>

<ul>
  <li>Added <a href="http://get-carbon.org/help/Get-IPAddress.html">Get-IPAddress</a> function for getting the IPv4/IPv6 addresses currently in use on the local computer’s network interfaces.</li>
  <li>Added <a href="http://get-carbon.org/help/Test-IPAddress.html">Test-IPAddress</a> function for testing if an IP address is in use on one the local computer’s network interfaces.</li>
</ul>

<h3 id="path">Path</h3>

<ul>
  <li>Added <a href="http://get-carbon.org/help/Test-UncPath.html">Test-UncPath</a> function for testing if a path is a UNC or not.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now runs script blocks in PowerShell 3 under a v2.0 CLR.</li>
</ul>

<h3 id="shares">Shares</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-SmbShare.html">Install-SmbShare</a> now creates the share’s directory if it doesn’t exist.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="certificates">Certificates</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Get-Certificate.html">Get-Certificate</a> throws an exception and halts script execution when loading a certificate file with a private key and the user doesn’t have permission to write to Windows’ MachineKeys directory.  It now writes an error instead.</li>
</ul>

<h3 id="powershell-1">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> doesn’t run under a v2.0 CLR when using parameters <code>-Runtime 'v2.0'</code>.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/08/carbon-v14-released.html">Carbon v1.4 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-10T03:50:00-07:00" pubdate data-updated="true">Aug 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.4 is out and is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.3.  This release adds a few new features and some bug fixes introduced in v1.3.</p>

<p>This will most likely be the last version of Carbon tested and supported on PowerShell 2.  We’ll be moving the build server to PowerShell 3 sometime around August 15th, which means that’s the version of PowerShell the automated tests will use.  We encourage everyone to upgrade to PowerShell 3 as soon as possible.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="file-system">File System</h3>

<ul>
  <li>Created <a href="http://get-carbon.org/help/Install-Junction.html">Install-Junction</a> function for creating new and/or updating existing junctions. This is a more idempotent way of creating junctions, as opposed to <a href="http://get-carbon.org/help/New-Junction.html">New-Junction</a> and <a href="http://get-carbon.org/help/Remove-Junction.html">Remove-Junction</a> which report errors if a junction already exists or doesn’t exist, respectively.</li>
</ul>

<h3 id="iis">IIS</h3>

<ul>
  <li>Objects returned by <a href="http://get-carbon.org/help/Get-IisWebsite.html">Get-IisWebsite</a> now have a dynamic <code>PhysicalPath</code> script property, so you don’t have to traverse down into the default application’s default virtual directory object to get it.</li>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a>, <a href="http://get-carbon.org/help/Install-IisWebsite.html">Install-IisWebsite</a>, and <a href="http://get-carbon.org/help/Install-IisVirtualDirectory.html">Install-IisVirtualDirectory</a> now canonicalize physical paths, i.e. they convert any path with a relative part (e.g. ‘..’) to a full path.  It turns out IIS doesn’t like paths with relative parts.</li>
  <li>Created <a href="http://get-carbon.org/help/Get-IisApplication.html">Get-IisApplication</a> function to get <code>Microsoft.Web.Administration.Application</code> objects for all or specific applications under a website.</li>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a> now uses the <code>Microsoft.Web.Administration</code> API instead of <code>appcmd.exe</code>.</li>
</ul>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li>Added <code>ExecutionPolicy</code> parameter to <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> to allow setting a custom exeuction policy when using <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> to run a script.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="iis-1">IIS</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Install-IisApplication.html">Install-IisApplication</a> not updating/changing physical path on existing application.</li>
</ul>

<h3 id="net">.NET</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-DotNetAppSetting.html">Set-DotNetAppSetting</a> and <a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString</a> failed if setting .NET configuration under an architecture where the PowerShell execution policy doesn’t allow running scripts.</li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/07/carbon-v13-released.html">Carbon v1.3 Released</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-08T21:39:00-07:00" pubdate data-updated="true">Jul 8<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://get-carbon.org">Carbon</a> v1.3 is out, is <a href="http://semver.org">backwards compatible</a> with v1.0 through v1.2.  This release  improves PowerShell 3 compatibility, updates <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> so it can run scripts, and adds <a href="http://get-carbon.org/help/ConvertTo-Base64.html">ConvertTo-Base64</a> and <a href="http://get-carbon.org/help/ConvertFrom-Base64.html">ConvertFrom-Base64</a> functions.</p>

<p>Thanks to <a href="http://blog.codeassassin.com/">Jason Stangroome</a> for the feedback that contributed to the work done in this release.</p>

<p><a href="https://bitbucket.org/splatteredbits/carbon/downloads">Get the bits at BitBucket.</a></p>

<h2 id="enhancements">Enhancements</h2>

<h3 id="powershell">PowerShell</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now supports running an external script.</li>
  <li>Added <code>OutputFormat</code> argument to <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> so your scripts/script blocks can return XML results instead of plain text.</li>
  <li>Renamed <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a>’s <code>Args</code> parameter to <code>ArgumentList</code> (with backwards compatibile <code>Args</code> alias).</li>
  <li>Renamed <a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a>’s <code>Command</code> parameter to <code>ScriptBlock</code> (with backwards-compatible <code>Command</code> alias).</li>
  <li><a href="http://get-carbon.org/help/Invoke-PowerShell.html">Invoke-PowerShell</a> now runs 64-bit PowerShell from 32-bit PowerShell.</li>
  <li><a href="http://get-carbon.org/help/Get-PowerShellPath.html">Get-PowerShellPath</a> now returns path for 64-bit PowerShell when running 32-bit PowerShell.</li>
</ul>

<h3 id="text">Text</h3>

<ul>
  <li>Created new <a href="http://get-carbon.org/help/ConvertTo-Base64.html">ConvertTo-Base64</a> function for encoding strings in base-64.</li>
  <li>Created new <a href="http://get-carbon.org/help/ConvertFrom-Base64.html">ConvertFrom-Base64</a> function for decoding base-64 strings.</li>
</ul>

<h2 id="bug-fixes">Bug Fixes</h2>

<h3 id="net">.NET</h3>

<ul>
  <li><a href="http://get-carbon.org/help/Set-DotNetAppSetting.html">Set-DotNetAppSetting</a> and <a href="http://get-carbon.org/help/Set-DotNetConnectionString.html">Set-DotNetConnectionString</a> weren’t able to set .NET 2.0 app settings and connections string when running under PowerShell 3.</li>
</ul>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/2/">&larr; Older</a>
    
    <a href="/archive">Archive</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section style="margin-top:2em;">

	<p>
		<a href="http://twitter.com/pshdo"><img src="/storage/twitter.png" alt="" width="32" height="32" style="border:none;vertical-align:middle;" ></a>
		
		<a href="http://twitter.com/pshdo" >Follow on Twitter</a>
	</p>

</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/10/carbon-2.0.0-released.html">Carbon 2.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/carbon-1.9.0-released.html">Carbon 1.9.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/09/carbon-2.0-alpha.26-released.html">Carbon 2.0-alpha.26 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/09/carbon-1.8-released.html">Carbon 1.8 Released</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/carbon-1-dot-7-released.html">Carbon 1.7 Released</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Aaron Jensen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
